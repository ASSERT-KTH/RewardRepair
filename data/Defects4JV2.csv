bugid	bug	buggy	patch	lineNo	action
272	Compress_12	buggy:  currEntry  =  new  TarArchiveEntry(headerBuf);  context:  readBuf  =  null;  }  byte[]  headerBuf  =  getRecord();  if  (hasHitEOF)  {  currEntry  =  null;  return  null;  }      currEntry  =  new  TarArchiveEntry(headerBuf);  entryOffset  =  0;  entrySize  =  currEntry.getSize();  	try  {  currEntry  =  new  TarArchiveEntry(headerBuf);  }  catch  (IllegalArgumentException  e)  {  IOException  ioe  =  new  IOException( "Error  detected  parsing  the  header ");  ioe.initCause(e);  throw  ioe;  }  	198	replace-1
505	Jsoup_19	buggy:  context:  }  else  {  //  no  attributes  defined  for  tag,  try  :all  tag  return  !tagName.equals( ":all ")  &&  isSafeAttribute( ":all ",  el,  attr);  }  return  false;  }  private  boolean  testValidProtocol(Element  el,  Attribute  attr,  Set<Protocol>  protocols)  {  String  value  =  el.absUrl(attr.getKey());  if  (!preserveRelativeLinks)  attr.setValue(value);  for  (Protocol  protocol  :  protocols)  {  String  prot  =  protocol.toString()  +   ": ";  if  (value.toLowerCase().startsWith(prot))  {  return  true;  }  	if  (value.length()  ==  0)  value  =  attr.getValue();  //  if  it  could  not  be  made  abs,  run  as-is  to  allow  custom  unknown  protocols  	342	add
305	Compress_45	buggy:  formatBigIntegerBinary(value,  buf,  offset,  length,  negative);  context:  final  long  maxAsOctalChar  =  length  ==  TarConstants.UIDLEN  ?  TarConstants.MAXID  :  TarConstants.MAXSIZE;  final  boolean  negative  =  value  <  0;  if  (!negative  &&  value  <=  maxAsOctalChar)  {  //  OK  to  store  as  octal  chars  return  formatLongOctalBytes(value,  buf,  offset,  length);  }  if  (length  <  9)  {  formatLongBinary(value,  buf,  offset,  length,  negative);  }      formatBigIntegerBinary(value,  buf,  offset,  length,  negative);  buf[offset]  =  (byte)  (negative  ?  0xff  :  0x80);  return  offset  +  length;  }  private  static  void  formatLongBinary(final  long  value,  final  byte[]  buf,  	}  else  {  formatBigIntegerBinary(value,  buf,  offset,  length,  negative);  	487	replace-1
465	JacksonDatabind_97	buggy:  gen.writeObject(_value);  context:  public  final  void  serialize(JsonGenerator  gen,  SerializerProvider  ctxt)  throws  IOException  {  if  (_value  ==  null)  {  ctxt.defaultSerializeNull(gen);  }  else  if  (_value  instanceof  JsonSerializable)  {  ((JsonSerializable)  _value).serialize(gen,  ctxt);  }  else  {      gen.writeObject(_value);  }  }  	ctxt.defaultSerializeValue(_value,  gen);  	114	replace-1
260	Codec_18	buggy:  return  CharSequenceUtils.regionMatches(cs1,  false,  0,  cs2,  0,  Math.max(cs1.length(),  cs2.length()));  context:  public  static  boolean  equals(final  CharSequence  cs1,  final  CharSequence  cs2)  {  if  (cs1  ==  cs2)  {  return  true;  }  if  (cs1  ==  null  ||  cs2  ==  null)  {  return  false;  }  if  (cs1  instanceof  String  &&  cs2  instanceof  String)  {  return  cs1.equals(cs2);  }      return  CharSequenceUtils.regionMatches(cs1,  false,  0,  cs2,  0,  Math.max(cs1.length(),  cs2.length()));  }  	return  cs1.length()  ==  cs2.length()  &&  CharSequenceUtils.regionMatches(cs1,  false,  0,  cs2,  0,  cs1.length());  	81	replace-1
313	Csv_6	buggy:  context:  <M  extends  Map<String,  String>>  M  putIn(final  M  map)  {  for  (final  Entry<String,  Integer>  entry  :  mapping.entrySet())  {  final  int  col  =  entry.getValue().intValue();  map.put(entry.getKey(),  values[col]);  }  return  map;  }  	if  (col  <  values.length)  {  }  	182	add
407	JacksonDatabind_39	buggy:  context:  public  Object  deserialize(JsonParser  p,  DeserializationContext  ctxt)  throws  IOException  {  p.skipChildren();  	if  (p.hasToken(JsonToken.FIELD_NAME))  {  while  (true)  {  JsonToken  t  =  p.nextToken();  if  ((t  ==  null)  ||  (t  ==  JsonToken.END_OBJECT))  {  break;  }  p.skipChildren();  }  }  else  {  }  	35	add
245	Codec_3	buggy:  }  else  if  (contains(value,  index  +  1,  4,   "IER "))  {  context:  !contains(value,  index  -  1,  3,   "RGY ",   "OGY "))  {  result.append('K',  'J');  index  +=  2;  }  else  if  (contains(value,  index  +  1,  1,   "E ",   "I ",   "Y ")  ||  contains(value,  index  -  1,  4,   "AGGI ",   "OGGI "))  {  if  ((contains(value,  0  ,4,   "VAN   ",   "VON   ")  ||  contains(value,  0,  3,   "SCH "))  ||  contains(value,  index  +  1,  2,   "ET "))  {  result.append('K');      }  else  if  (contains(value,  index  +  1,  4,   "IER "))  {  result.append('J');  }  else  {  result.append('J',  'K');  }  index  +=  2;  }  else  if  (charAt(value,  index  +  1)  ==  'G')  {  index  +=  2;  result.append('K');  	}  else  if  (contains(value,  index  +  1,  3,   "IER "))  {  	455	replace-1
410	JacksonDatabind_42	buggy:  context:  throw  new  IllegalArgumentException();  }  protected  Object  _deserializeFromEmptyString()  throws  IOException  {  if  (_kind  ==  STD_URI)  {  return  URI.create( " ");  }  return  super._deserializeFromEmptyString();  }  }  }  	if  (_kind  ==  STD_LOCALE)  {  return  Locale.ROOT;  }  	284	add
341	Gson_17	buggy:  if  (in.peek()  !=  JsonToken.STRING)  {  throw  new  JsonParseException( "The  date  should  be  a  string  value ");  context:  return;  }  synchronized  (localFormat)  {  String  dateFormatAsString  =  enUsFormat.format(value);  out.value(dateFormatAsString);  }  }  public  Date  read(JsonReader  in)  throws  IOException  {  if  (in.peek()  !=  JsonToken.STRING)  {    throw  new  JsonParseException( "The  date  should  be  a  string  value ");  }  Date  date  =  deserializeToDate(in.nextString());  if  (dateType  ==  Date.class)  {  return  date;  }  else  if  (dateType  ==  Timestamp.class)  {  	if  (in.peek()  ==  JsonToken.NULL)  {  in.nextNull();  return  null;  	99	replace-2
509	Jsoup_23	buggy:  context:  char  c  =  input.charAt(pos);  if  ((c  >=  'A'  &&  c  <=  'Z')  ||  (c  >=  'a'  &&  c  <=  'z'))  pos++;  else  break;  }  return  input.substring(start,  pos);  }  	String  consumeLetterThenDigitSequence()  {  int  start  =  pos;  while  (!isEmpty())  {  char  c  =  input.charAt(pos);  if  ((c  >=  'A'  &&  c  <=  'Z')  ||  (c  >=  'a'  &&  c  <=  'z'))  pos++;  else  break;  }  while  (!isEmpty())  {  char  c  =  input.charAt(pos);  if  (c  >=  '0'  &&  c  <=  '9')  pos++;  else  break;  }  return  input.substring(start,  pos);  }  	118	add
288	Compress_28	buggy:  count(totalRead);  context:  return  -1;  }  if  (currEntry  ==  null)  {  throw  new  IllegalStateException( "No  current  tar  entry ");  }  numToRead  =  Math.min(numToRead,  available());  totalRead  =  is.read(buf,  offset,  numToRead);      count(totalRead);  if  (totalRead  ==  -1)  {  hasHitEOF  =  true;  }  else  {  entryOffset  +=  totalRead;  	if  (numToRead  >  0)  {  throw  new  IOException( "Truncated  TAR  archive ");  }  count(totalRead);  	583	replace-1
383	JacksonDatabind_15	buggy:  JsonSerializer<?>  ser  =  provider.findValueSerializer(delegateType,  prop);  context:  {  final  AnnotationIntrospector  intr  =  provider.getAnnotationIntrospector();  if  (intr  !=  null)  {  AnnotatedMember  m  =  prop.getMember();  if  (m  !=  null)  {  Object  convDef  =  intr.findSerializationConverter(m);  if  (convDef  !=  null)  {  Converter<Object,Object>  conv  =  provider.converterInstance(prop.getMember(),  convDef);  JavaType  delegateType  =  conv.getOutputType(provider.getTypeFactory());          JsonSerializer<?>  ser  =  provider.findValueSerializer(delegateType,  prop);  return  new  StdDelegatingSerializer(conv,  delegateType,  ser);  }  }  }  return  null;  }  	JsonSerializer<?>  ser  =  delegateType.isJavaLangObject()  ?  null  :  provider.findValueSerializer(delegateType,  prop);  	370	replace-1
521	Jsoup_35	buggy:  context:  if  (lastNode.parent()  !=  null)  lastNode.remove();  tb.insertInFosterParent(lastNode);  }  else  {  if  (lastNode.parent()  !=  null)  lastNode.remove();  commonAncestor.appendChild(lastNode);  }  Element  adopter  =  new  Element(formatEl.tag(),  tb.getBaseUri());  Node[]  childNodes  =  furthestBlock.childNodes().toArray(new  Node[furthestBlock.childNodeSize()]);  for  (Node  childNode  :  childNodes)  {  adopter.appendChild(childNode);  //  append  will  reparent.  thus  the  clone  to  avoid  concurrent  mod.  }  furthestBlock.appendChild(adopter);  tb.removeFromActiveFormattingElements(formatEl);  tb.removeFromStack(formatEl);  tb.insertOnStackAfter(furthestBlock,  adopter);  	adopter.attributes().addAll(formatEl.attributes());  	726	add
548	Jsoup_62	buggy:  String  name  =  t.asEndTag().normalName();  context:  break;  case  EOF:  break;  }  return  true;  }  boolean  anyOtherEndTag(Token  t,  HtmlTreeBuilder  tb)  {      String  name  =  t.asEndTag().normalName();  ArrayList<Element>  stack  =  tb.getStack();  for  (int  pos  =  stack.size()  -1;  pos  >=  0;  pos--)  {  Element  node  =  stack.get(pos);  if  (node.nodeName().equals(name))  {  tb.generateImpliedEndTags(name);  if  (!name.equals(tb.currentElement().nodeName()))  tb.error(this);  tb.popStackToClose(name);  	String  name  =  t.asEndTag().name();  //  matches  with  case  sensitivity  if  enabled  	764	replace-1
265	Compress_5	buggy:  if  (read  ==  0  &&  inf.finished())  {  return  -1;  context:  if  (lengthOfLastRead  >  0)  {  bytesReadFromStream  +=  lengthOfLastRead;  }  }  int  read  =  0;  try  {  read  =  inf.inflate(buffer,  start,  length);  }  catch  (DataFormatException  e)  {  throw  new  ZipException(e.getMessage());  }      if  (read  ==  0  &&  inf.finished())  {      return  -1;  }  crc.update(buffer,  start,  read);  	if  (read  ==  0)  {  if  (inf.finished())  {  return  -1;  }  else  if  (lengthOfLastRead  ==  -1)  {  throw  new  IOException( "Truncated  ZIP  file ");  }  	239	replace-2
501	Jsoup_15	buggy:  }  else  if  (StringUtil.in(name,   "base ",   "basefont ",   "bgsound ",   "command ",   "link ",   "meta ",   "noframes ",   "style ",   "title "))  {  context:  Token.StartTag  startTag  =  t.asStartTag();  String  name  =  startTag.name();  if  (name.equals( "html "))  {  tb.error(this);  Element  html  =  tb.getStack().getFirst();  for  (Attribute  attribute  :  startTag.getAttributes())  {  if  (!html.hasAttr(attribute.getKey()))  html.attributes().put(attribute);  }          }  else  if  (StringUtil.in(name,   "base ",   "basefont ",   "bgsound ",   "command ",   "link ",   "meta ",   "noframes ",   "style ",   "title "))  {  return  tb.process(t,  InHead);  }  else  if  (name.equals( "body "))  {  tb.error(this);  LinkedList<Element>  stack  =  tb.getStack();  if  (stack.size()  ==  1  ||  (stack.size()  >  2  &&  !stack.get(1).nodeName().equals( "body ")))  {  return  false;  //  ignore  }  else  {  	}  else  if  (StringUtil.in(name,   "base ",   "basefont ",   "bgsound ",   "command ",   "link ",   "meta ",   "noframes ",   "script ",   "style ",   "title "))  {  	283	replace-1
28	Cli_2	buggy:  tokens.add( "- "  +  ch);  }  context:  break;  }  }  else  if  (stopAtNonOption)  {  process(token.substring(i));  }  else  {      tokens.add( "- "  +  ch);  }  }  }  }  \  No  newline  at  end  of  file  	tokens.add(token);  break;  }  	305	replace-2
442	JacksonDatabind_74	buggy:  context:  return  deser.deserialize(p,  ctxt);  }  Object  result  =  TypeDeserializer.deserializeIfNatural(p,  ctxt,  _baseType);  if  (result  !=  null)  {  return  result;  }  if  (p.getCurrentToken()  ==  JsonToken.START_ARRAY)  {  return  super.deserializeTypedFromAny(p,  ctxt);  }  ctxt.reportWrongTokenException(p,  JsonToken.FIELD_NAME,   "missing  property  ' "+_typePropertyName+ "'  that  is  to  contain  type  id  (for  class   "+baseTypeName()+ ") ");  	}  else  if  (p.getCurrentToken()  ==  JsonToken.VALUE_STRING)  {  if  (ctxt.isEnabled(DeserializationFeature.ACCEPT_EMPTY_STRING_AS_NULL_OBJECT))  {  String  str  =  p.getText().trim();  if  (str.isEmpty())  {  return  null;  }  }  	156	add
430	JacksonDatabind_62	buggy:  context:  JsonDeserializer<Object>  delegateDeser  =  null;  if  (_valueInstantiator  !=  null)  {  if  (_valueInstantiator.canCreateUsingDelegate())  {  JavaType  delegateType  =  _valueInstantiator.getDelegateType(ctxt.getConfig());  if  (delegateType  ==  null)  {  throw  new  IllegalArgumentException( "Invalid  delegate-creator  definition  for   "+_collectionType  }  delegateDeser  =  findDeserializer(ctxt,  delegateType,  property);  }  }  	}  else  if  (_valueInstantiator.canCreateUsingArrayDelegate())  {  JavaType  delegateType  =  _valueInstantiator.getArrayDelegateType(ctxt.getConfig());  if  (delegateType  ==  null)  {  throw  new  IllegalArgumentException( "Invalid  array-delegate-creator  definition  for   "+_collectionType  + ":  value  instantiator  ( "+_valueInstantiator.getClass().getName()  + ")  returned  true  for  'canCreateUsingArrayDelegate()',  but  null  for  'getArrayDelegateType()' ");  }  delegateDeser  =  findDeserializer(ctxt,  delegateType,  property);  	184	add
600	JxPath_21	buggy:  return  ValueUtils.getLength(getBaseValue());  context:  Object  value  =  getNode();  return  value  ==  null  ||  JXPathIntrospector.getBeanInfo(value.getClass()).isAtomic();  }  public  int  getLength()  {      return  ValueUtils.getLength(getBaseValue());  }  	Object  baseValue  =  getBaseValue();  return  baseValue  ==  null  ?  1  :  ValueUtils.getLength(baseValue);  	152	replace-1
540	Jsoup_54	buggy:  context:  public  void  tail(org.jsoup.nodes.Node  source,  int  depth)  {  if  (source  instanceof  org.jsoup.nodes.Element  &&  dest.getParentNode()  instanceof  Element)  {  dest  =  (Element)  dest.getParentNode();  //  undescend.  cromulent.  }  }  private  void  copyAttributes(org.jsoup.nodes.Node  source,  Element  el)  {  for  (Attribute  attribute  :  source.attributes())  {  String  key  =  attribute.getKey().replaceAll( "[^-a-zA-Z0-9_:.] ",   " ");  el.setAttribute(key,  attribute.getValue());  }  }  private  String  updateNamespaces(org.jsoup.nodes.Element  el)  {  	if  (key.matches( "[a-zA-Z_:]{1}[-a-zA-Z0-9_:.]* "))  	126	add
403	JacksonDatabind_35	buggy:  if  (p.getCurrentToken()  !=  JsonToken.START_OBJECT)  {  throw  ctxt.wrongTokenException(p,  JsonToken.START_OBJECT,   "need  JSON  Object  to  contain  As.WRAPPER_OBJECT  type  information  for  class   "+baseTypeName());  }  context:  private  final  Object  _deserialize(JsonParser  p,  DeserializationContext  ctxt)  throws  IOException  {  if  (p.canReadTypeId())  {  Object  typeId  =  p.getTypeId();  if  (typeId  !=  null)  {  return  _deserializeWithNativeTypeId(p,  ctxt,  typeId);  }  }      if  (p.getCurrentToken()  !=  JsonToken.START_OBJECT)  {      throw  ctxt.wrongTokenException(p,  JsonToken.START_OBJECT,           "need  JSON  Object  to  contain  As.WRAPPER_OBJECT  type  information  for  class   "+baseTypeName());      }  if  (p.nextToken()  !=  JsonToken.FIELD_NAME)  {  throw  ctxt.wrongTokenException(p,  JsonToken.FIELD_NAME,   "need  JSON  String  that  contains  type  id  (for  subtype  of   "+baseTypeName()+ ") ");  	JsonToken  t  =  p.getCurrentToken();  if  (t  ==  JsonToken.START_OBJECT)  {  }  else  if  (t  !=  JsonToken.FIELD_NAME)  {  throw  ctxt.wrongTokenException(p,  JsonToken.START_OBJECT,   "need  JSON  Object  to  contain  As.WRAPPER_OBJECT  type  information  for  class   "+baseTypeName());  }  	89	replace-4
356	JacksonCore_14	buggy:  if  ((toRelease  !=  src)  &&  (toRelease.length  <=  src.length))  {  throw  wrongBuf();  }  if  ((toRelease  !=  src)  &&  (toRelease.length  <=  src.length))  {  throw  wrongBuf();  }  return  new  IllegalArgumentException( "Trying  to  release  buffer  not  owned  by  the  context ");  context:  protected  final  void  _verifyAlloc(Object  buffer)  {  if  (buffer  !=  null)  {  throw  new  IllegalStateException( "Trying  to  call  same  allocXxx()  method  second  time ");  }  }  protected  final  void  _verifyRelease(byte[]  toRelease,  byte[]  src)  {      if  ((toRelease  !=  src)  &&  (toRelease.length  <=  src.length))  {  throw  wrongBuf();  }  }  protected  final  void  _verifyRelease(char[]  toRelease,  char[]  src)  {      if  ((toRelease  !=  src)  &&  (toRelease.length  <=  src.length))  {  throw  wrongBuf();  }  }  	if  ((toRelease  !=  src)  &&  (toRelease.length  <  src.length))  {  throw  wrongBuf();  }  if  ((toRelease  !=  src)  &&  (toRelease.length  <  src.length))  {  throw  wrongBuf();  }  return  new  IllegalArgumentException( "Trying  to  release  buffer  smaller  than  original ");  	274	replace-3
387	JacksonDatabind_19	buggy:  context:  return  _constructType(type.getUpperBounds()[0],  context);  }  private  JavaType  _mapType(Class<?>  rawClass)  {  JavaType[]  typeParams  =  findTypeParameters(rawClass,  Map.class);  if  (typeParams  ==  null)  {  return  MapType.construct(rawClass,  _unknownType(),  _unknownType());  }  if  (typeParams.length  !=  2)  {  	if  (rawClass  ==  Properties.class)  {  return  MapType.construct(rawClass,  CORE_TYPE_STRING,  CORE_TYPE_STRING);  }  	1021	add
525	Jsoup_39	buggy:  context:  }  else  {  //  specified  by  content  type  header  (or  by  user  on  file  load)  Validate.notEmpty(charsetName,   "Must  set  charset  arg  to  character  set  of  file  to  parse.  Set  to  null  to  attempt  to  detect  from  HTML ");  docData  =  Charset.forName(charsetName).decode(byteData).toString();  }  if  (docData.length()  >  0  &&  docData.charAt(0)  ==  65279)  {  byteData.rewind();  docData  =  Charset.forName(defaultCharset).decode(byteData).toString();  docData  =  docData.substring(1);  charsetName  =  defaultCharset;  }  if  (doc  ==  null)  {  doc  =  parser.parseInput(docData,  baseUri);  doc.outputSettings().charset(charsetName);  }  return  doc;  }  	doc  =  null;  	119	add
375	JacksonDatabind_7	buggy:  context:  }  }  public  TokenBuffer  deserialize(JsonParser  jp,  DeserializationContext  ctxt)  throws  IOException  {  copyCurrentStructure(jp);  	if  (jp.getCurrentTokenId()  !=  JsonToken.FIELD_NAME.id())  {  return  this;  }  JsonToken  t;  writeStartObject();  do  {  copyCurrentStructure(jp);  }  while  ((t  =  jp.nextToken())  ==  JsonToken.FIELD_NAME);  if  (t  !=  JsonToken.END_OBJECT)  {  throw  ctxt.mappingException( "Expected  END_OBJECT  after  copying  contents  of  a  JsonParser  into  TokenBuffer,  got   "+t);  }  writeEndObject();  	405	add
292	Compress_32	buggy:  currEntry.setGroupId(Integer.parseInt(val));  currEntry.setUserId(Integer.parseInt(val));  context:  for  (Entry<String,  String>  ent  :  headers.entrySet()){  String  key  =  ent.getKey();  String  val  =  ent.getValue();  if  ( "path ".equals(key)){  currEntry.setName(val);  }  else  if  ( "linkpath ".equals(key)){  currEntry.setLinkName(val);  }  else  if  ( "gid ".equals(key)){      currEntry.setGroupId(Integer.parseInt(val));  }  else  if  ( "gname ".equals(key)){  currEntry.setGroupName(val);  }  else  if  ( "uid ".equals(key)){      currEntry.setUserId(Integer.parseInt(val));  }  else  if  ( "uname ".equals(key)){  currEntry.setUserName(val);  }  else  if  ( "size ".equals(key)){  	currEntry.setGroupId(Long.parseLong(val));  currEntry.setUserId(Long.parseLong(val));  	501	replace-2
426	JacksonDatabind_58	buggy:  context:  JavaType  propType0)  throws  JsonMappingException  {  AnnotatedMember  mutator  =  propDef.getNonConstructorMutator();  if  (ctxt.canOverrideAccessModifiers())  {  mutator.fixAccess(ctxt.isEnabled(MapperFeature.OVERRIDE_PUBLIC_ACCESS_MODIFIERS));  }  BeanProperty.Std  property  =  new  BeanProperty.Std(propDef.getFullName(),  propType0,  propDef.getWrapperName(),  	if  ((mutator  instanceof  AnnotatedField)  &&   "cause ".equals(mutator.getName()))  {  ;  }  else  {  }  	715	add
427	JacksonDatabind_59	buggy:  context:  _superClass,  _superInterfaces,  _elementType,  h,  _typeHandler,  _asStatic);  }  public  CollectionLikeType  withContentValueHandler(Object  h)  {  return  new  CollectionLikeType(_class,  _bindings,  _superClass,  _superInterfaces,  _elementType.withValueHandler(h),  _valueHandler,  _typeHandler,  _asStatic);  }  	@Override  public  JavaType  withHandlersFrom(JavaType  src)  {  JavaType  type  =  super.withHandlersFrom(src);  JavaType  srcCt  =  src.getContentType();  if  (srcCt  !=  null)  {  JavaType  ct  =  _elementType.withHandlersFrom(srcCt);  if  (ct  !=  _elementType)  {  type  =  type.withContentType(ct);  }  }  return  type;  }  	136	add
566	Jsoup_80	buggy:  context:  }  void  insert(Token.Comment  commentToken)  {  Comment  comment  =  new  Comment(commentToken.getData());  Node  insert  =  comment;  if  (commentToken.bogus)  {  //  xml  declarations  are  emitted  as  bogus  comments  (which  is  right  for  html,  but  not  xml)  String  data  =  comment.getData();  if  (data.length()  >  1  &&  (data.startsWith( "! ")  ||  data.startsWith( "? ")))  {  Document  doc  =  Jsoup.parse( "< "  +  data.substring(1,  data.length()  -1)  +   "> ",  baseUri,  Parser.xmlParser());  Element  el  =  doc.child(0);  insert  =  new  XmlDeclaration(settings.normalizeTag(el.tagName()),  data.startsWith( "! "));  insert.attributes().addAll(el.attributes());  }  }  insertNode(insert);  }  	if  (doc.childNodeSize()  >  0)  {  }  //  else,  we  couldn't  parse  it  as  a  decl,  so  leave  as  a  comment  	91	add
524	Jsoup_38	buggy:  context:  tb.framesetOk(false);  }  else  if  (StringUtil.in(name,  Constants.InBodyStartMedia))  {  tb.insertEmpty(startTag);  }  else  if  (name.equals( "hr "))  {  if  (tb.inButtonScope( "p "))  {  tb.process(new  Token.EndTag( "p "));  }  tb.insertEmpty(startTag);  tb.framesetOk(false);  }  else  if  (name.equals( "image "))  {  return  tb.process(startTag.name( "img "));  //  change  <image>  to  <img>,  unless  in  svg  }  else  if  (name.equals( "isindex "))  {  tb.error(this);  if  (tb.getFormElement()  !=  null)  return  false;  	if  (tb.getFromStack( "svg ")  ==  null)  else  tb.insert(startTag);  	455	add
285	Compress_25	buggy:  context:  public  ZipArchiveInputStream(InputStream  inputStream,  String  encoding,  boolean  useUnicodeExtraFields,  boolean  allowStoredEntriesWithDataDescriptor)  {  zipEncoding  =  ZipEncodingHelper.getZipEncoding(encoding);  this.useUnicodeExtraFields  =  useUnicodeExtraFields;  in  =  new  PushbackInputStream(inputStream,  buf.capacity());  this.allowStoredEntriesWithDataDescriptor  =  allowStoredEntriesWithDataDescriptor;  }  public  ZipArchiveEntry  getNextZipEntry()  throws  IOException  {  boolean  firstEntry  =  true;  if  (closed  ||  hitCentralDirectory)  {  return  null;  }  if  (current  !=  null)  {  closeEntry();  	buf.limit(0);  	184	add
488	Jsoup_2	buggy:  context:  isEmptyElement  =  true;  }  else  {  tq.matchChomp( "> ");  }  addChildToParent(child,  isEmptyElement);  if  (tag.isData())  {  String  data  =  tq.chompTo( "</ "  +  tagName);  tq.chompTo( "> ");  Node  dataNode;  if  (tag.equals(titleTag)  ||  tag.equals(textareaTag))  //  want  to  show  as  text,  but  not  contain  inside  tags  (so  not  a  data  tag?)  dataNode  =  TextNode.createFromEncoded(data,  baseUri);  else  dataNode  =  new  DataNode(data,  baseUri);  //  data  not  encoded  but  raw  (for   "  in  script)  child.appendChild(dataNode);  }  	popStackToClose(tag);  	148	add
68	Collections_28	buggy:  context:  public  boolean  isToInclusive()  {  return  false;  }  protected  SortedMap<K,  V>  createRangeMap(final  K  fromKey,  final  boolean  fromInclusive,  final  K  toKey,  final  boolean  toInclusive)  {  return  new  RangeEntryMap(fromKey,  fromInclusive,  toKey,  toInclusive);  }  	@Override  public  void  clear()  {  Iterator<Map.Entry<K,  V>>  it  =  AbstractPatriciaTrie.this.entrySet().iterator();  Set<K>  currentKeys  =  keySet();  while  (it.hasNext())  {  if  (currentKeys.contains(it.next().getKey()))  {  it.remove();  }  }  }  	2262	add
402	JacksonDatabind_34	buggy:  visitFloatFormat(visitor,  typeHint,  JsonParser.NumberType.BIG_INTEGER);  context:  }  public  void  acceptJsonFormatVisitor(JsonFormatVisitorWrapper  visitor,  JavaType  typeHint)  throws  JsonMappingException  {  if  (_isInt)    visitIntFormat(visitor,  typeHint,  JsonParser.NumberType.BIG_INTEGER);  }  else  {  Class<?>  h  =  handledType();  if  (h  ==  BigDecimal.class)  {      visitFloatFormat(visitor,  typeHint,  JsonParser.NumberType.BIG_INTEGER);  }  else  {  }  }  }  }  \  No  newline  at  end  of  file  	visitFloatFormat(visitor,  typeHint,  JsonParser.NumberType.BIG_DECIMAL);  	81	replace-1
357	JacksonCore_15	buggy:  context:  public  JsonToken  nextToken()  throws  IOException  {  	if(!_allowMultipleMatches  &&  _currToken  !=  null  &&  _exposedContext  ==  null){  if((_currToken.isStructEnd()    &&  _headContext.isStartHandled())  ){  return  (_currToken  =  null);  }  else  if(_currToken.isScalarValue()  &&  !_headContext.isStartHandled()  &&  !_includePath  &&  _itemFilter  ==  TokenFilter.INCLUDE_ALL)  {  return  (_currToken  =  null);  }  }  	227	add
257	Codec_15	buggy:  final  char  hwChar  =  str.charAt(index  -  1);  if  ('H'  ==  hwChar  ||  'W'  ==  hwChar)  {  final  char  preHWChar  =  str.charAt(index  -  2);  final  char  firstCode  =  this.map(preHWChar);  if  (firstCode  ==  mappedChar  ||  'H'  ==  preHWChar  ||  'W'  ==  preHWChar)  {  context:  private  char  getMappingCode(final  String  str,  final  int  index)  {  final  char  mappedChar  =  this.map(str.charAt(index));  if  (index  >  1  &&  mappedChar  !=  '0')  {      final  char  hwChar  =  str.charAt(index  -  1);      if  ('H'  ==  hwChar  ||  'W'  ==  hwChar)  {      final  char  preHWChar  =  str.charAt(index  -  2);      final  char  firstCode  =  this.map(preHWChar);      if  (firstCode  ==  mappedChar  ||  'H'  ==  preHWChar  ||  'W'  ==  preHWChar)  {  return  0;  }  	for  (int  i=index-1  ;  i>=0  ;  i--)  {  final  char  prevChar  =  str.charAt(i);  if  (this.map(prevChar)==mappedChar)  {  if  ('H'!=prevChar  &&  'W'!=prevChar)  {  break;  }  	188	replace-5
541	Jsoup_55	buggy:  context:  t.tagPending.selfClosing  =  true;  t.emitTagPending();  t.transition(Data);  break;  case  eof:  t.eofError(this);  t.transition(Data);  break;  default:  t.error(this);  t.transition(BeforeAttributeName);  }  }  },  BogusComment  {  void  read(Tokeniser  t,  CharacterReader  r)  {  r.unconsume();  	r.unconsume();  	883	add
529	Jsoup_43	buggy:  if  (element.equals(search))  context:  List<Element>  siblings  =  parent().children();  return  siblings.size()  >  1  ?  siblings.get(siblings.size()  -  1)  :  null;  }  private  static  <E  extends  Element>  Integer  indexInList(Element  search,  List<E>  elements)  {  Validate.notNull(search);  Validate.notNull(elements);  for  (int  i  =  0;  i  <  elements.size();  i++)  {  E  element  =  elements.get(i);      if  (element.equals(search))  return  i;  }  return  null;  }  	if  (element  ==  search)  	574	replace-1
264	Compress_4	buggy:  context:  Change  change  =  (Change)  it.next();  if  (change.type()  ==  Change.TYPE_ADD  &&  !change.isReplaceMode()  &&  !results.hasBeenAdded(change.getEntry().getName()))  {  copyStream(change.getInput(),  out,  change.getEntry());  it.remove();  results.addedFromChangeSet(change.getEntry().getName());  }  }  return  results;  }  	out.finish();  	128	add
500	Jsoup_14	buggy:  context:  }  }  },  RcdataLessthanSign  {  void  read(Tokeniser  t,  CharacterReader  r)  {  if  (r.matches('/'))  {  t.createTempBuffer();  t.advanceTransition(RCDATAEndTagOpen);  }  else  {  t.emit( "< ");  t.transition(Rcdata);  	}  else  if  (r.matchesLetter()  &&  !r.containsIgnoreCase( "</ "  +  t.appropriateEndTagName()))  {  t.tagPending  =  new  Token.EndTag(t.appropriateEndTagName());  t.emitTagPending();  r.unconsume();  //  undo   "< "  t.transition(Data);  	218	add
36	Cli_11	buggy:  if  (option.hasArg()  &&  (option.getArgName()  !=  null))  context:  if  (option.getOpt()  !=  null)  {  buff.append( "- ").append(option.getOpt());  }  else  {  buff.append( "-- ").append(option.getLongOpt());  }      if  (option.hasArg()  &&  (option.getArgName()  !=  null))  {  buff.append( "  < ").append(option.getArgName()).append( "> ");  }  if  (!required)  {  buff.append( "] ");  	if  (option.hasArg()  &&  option.hasArgName())  	632	replace-1
549	Jsoup_63	buggy:  if  (tag.isSelfClosing())  tokeniser.acknowledgeSelfClosingFlag();  else  {  tokeniser.acknowledgeSelfClosingFlag();  }  context:  insertNode(el);  stack.add(el);  }  Element  insertEmpty(Token.StartTag  startTag)  {  Tag  tag  =  Tag.valueOf(startTag.name(),  settings);  Element  el  =  new  Element(tag,  baseUri,  startTag.attributes);  insertNode(el);  if  (startTag.isSelfClosing())  {  if  (tag.isKnownTag())  {      if  (tag.isSelfClosing())  tokeniser.acknowledgeSelfClosingFlag();  }      else  {  tag.setSelfClosing();      tokeniser.acknowledgeSelfClosingFlag();      }  }  	if  (!tag.isEmpty())  tokeniser.error( "Tag  cannot  be  self  closing;  not  a  void  tag ");  else  //  unknown  tag,  remember  this  is  self  closing  for  output  	227	replace-4
595	JxPath_16	buggy:  return  (node  instanceof  Element)  ||  (node  instanceof  Document);  context:  .equals(JDOMNodePointer.getLocalName(node)))  {  String  nodeNS  =  JDOMNodePointer.getNamespaceURI(node);  return  equalStrings(namespaceURI,  nodeNS)  ||  nodeNS  ==  null  &&  equalStrings(testPrefix,  getPrefix(node));  }  return  false;  }  if  (test  instanceof  NodeTypeTest)  {  switch  (((NodeTypeTest)  test).getNodeType())  {  case  Compiler.NODE_TYPE_NODE  :          return  (node  instanceof  Element)  ||  (node  instanceof  Document);  case  Compiler.NODE_TYPE_TEXT  :  return  (node  instanceof  Text)  ||  (node  instanceof  CDATA);  case  Compiler.NODE_TYPE_COMMENT  :  return  node  instanceof  Comment;  case  Compiler.NODE_TYPE_PI  :  return  node  instanceof  ProcessingInstruction;  }  return  false;  	return  true;  	391	replace-1
520	Jsoup_34	buggy:  if  (offset  <  length)  {  context:  int  nextIndexOf(CharSequence  seq)  {  char  startChar  =  seq.charAt(0);  for  (int  offset  =  pos;  offset  <  length;  offset++)  {  if  (startChar  !=  input[offset])  while(++offset  <  length  &&  startChar  !=  input[offset]);  int  i  =  offset  +  1;  int  last  =  i  +  seq.length()-1;      if  (offset  <  length)  {  for  (int  j  =  1;  i  <  last  &&  seq.charAt(j)  ==  input[i];  i++,  j++);  if  (i  ==  last)  //  found  full  sequence  return  offset  -  pos;  }  }  return  -1;  }  	if  (offset  <  length  &&  last  <=  length)  {  	91	replace-1
56	Cli_31	buggy:  if  (option.hasArg()  &&  option.hasArgName())  buff.append( "< ").append(option.getArgName()).append( "> ");  context:  if  (option.getOpt()  !=  null)  {  buff.append( "- ").append(option.getOpt());  }  else  {  buff.append( "-- ").append(option.getLongOpt());  }      if  (option.hasArg()  &&  option.hasArgName())  {  buff.append(option.getOpt()  ==  null  ?  longOptSeparator  :   "   ");      buff.append( "< ").append(option.getArgName()).append( "> ");  }  if  (!required)  	if  (option.hasArg()  &&  (option.getArgName()  ==  null  ||  option.getArgName().length()  !=  0))  buff.append( "< ").append(option.getArgName()  !=  null  ?  option.getArgName()  :  getArgName()).append( "> ");  	653	replace-2
365	JacksonCore_23	buggy:  context:  }  public  DefaultPrettyPrinter  createInstance()  {  return  new  DefaultPrettyPrinter(this);  }  	if  (getClass()  !=  DefaultPrettyPrinter.class)  {  //  since  2.10  throw  new  IllegalStateException( "Failed  `createInstance()`:   "+getClass().getName()  + "  does  not  override  method;  it  has  to ");  }  	255	add
52	Cli_27	buggy:  if  (selected  ==  null  ||  selected.equals(option.getOpt()))  selected  =  option.getOpt();  context:  if  (option  ==  null)  {  selected  =  null;  return;  }      if  (selected  ==  null  ||  selected.equals(option.getOpt()))  {      selected  =  option.getOpt();  }  else  {  throw  new  AlreadySelectedException(this,  option);  }  	if  (selected  ==  null  ||  selected.equals(option.getKey()))  selected  =  option.getKey();  	98	replace-2
330	Gson_6	buggy:  context:  typeAdapter  =  constructorConstructor.get(TypeToken.get(typeAdapterClass)).construct();  }  else  if  (TypeAdapterFactory.class.isAssignableFrom(value))  {  Class<TypeAdapterFactory>  typeAdapterFactory  =  (Class<TypeAdapterFactory>)  value;  typeAdapter  =  constructorConstructor.get(TypeToken.get(typeAdapterFactory))  .construct()  .create(gson,  fieldType);  }  else  {  throw  new  IllegalArgumentException(   "@JsonAdapter  value  must  be  TypeAdapter  or  TypeAdapterFactory  reference. ");  }  typeAdapter  =  typeAdapter.nullSafe();  return  typeAdapter;  }  }  	if  (typeAdapter  !=  null)  {  }  	67	add
561	Jsoup_75	buggy:  if  (!(out.syntax()  ==  Document.OutputSettings.Syntax.html  &&  (val  ==  null  ||  val.equals(key)  &&  Attribute.isBooleanAttribute(key))))  {  context:  final  void  html(final  Appendable  accum,  final  Document.OutputSettings  out)  throws  IOException  {  final  int  sz  =  size;  for  (int  i  =  0;  i  <  sz;  i++)  {  final  String  key  =  keys[i];  final  String  val  =  vals[i];  accum.append('  ').append(key);      if  (!(out.syntax()  ==  Document.OutputSettings.Syntax.html      &&  (val  ==  null  ||  val.equals(key)  &&  Attribute.isBooleanAttribute(key))))  {  accum.append( "=\ " ");  Entities.escape(accum,  val  ==  null  ?  EmptyString  :  val,  out,  true,  false,  false);  accum.append(' "');  }  }  }  	if  (!Attribute.shouldCollapseAttribute(key,  val,  out))  {  	319	replace-2
480	JacksonDatabind_112	buggy:  AnnotatedWithParams  delegateCreator  =  _valueInstantiator.getDelegateCreator();  context:  public  JsonDeserializer<?>  createContextual(DeserializationContext  ctxt,  BeanProperty  property)  throws  JsonMappingException  {  JsonDeserializer<Object>  delegate  =  null;  if  (_valueInstantiator  !=  null)  {      AnnotatedWithParams  delegateCreator  =  _valueInstantiator.getDelegateCreator();  if  (delegateCreator  !=  null)  {  JavaType  delegateType  =  _valueInstantiator.getDelegateType(ctxt.getConfig());  delegate  =  findDeserializer(ctxt,  delegateType,  property);  }  }  	AnnotatedWithParams  delegateCreator  =  _valueInstantiator.getArrayDelegateCreator();  JavaType  delegateType  =  _valueInstantiator.getArrayDelegateType(ctxt.getConfig());  delegate  =  findDeserializer(ctxt,  delegateType,  property);  }  else  if  ((delegateCreator  =  _valueInstantiator.getDelegateCreator())  !=  null)  {  	107	replace-1
244	Codec_2	buggy:  if  (lineLength  >  0)  {  context:  case  2:  buf[pos++]  =  encodeTable[(x  >>  10)  &  MASK_6BITS];  buf[pos++]  =  encodeTable[(x  >>  4)  &  MASK_6BITS];  buf[pos++]  =  encodeTable[(x  <<  2)  &  MASK_6BITS];  if  (encodeTable  ==  STANDARD_ENCODE_TABLE)  {  buf[pos++]  =  PAD;  }  break;  }      if  (lineLength  >  0)  {  System.arraycopy(lineSeparator,  0,  buf,  pos,  lineSeparator.length);  pos  +=  lineSeparator.length;  }  }  else  {  for  (int  i  =  0;  i  <  inAvail;  i++)  {  if  (buf  ==  null  ||  buf.length  -  pos  <  encodeSize)  {  resizeBuf();  }  	if  (lineLength  >  0  &&  pos  >  0)  {  	446	replace-1
361	JacksonCore_19	buggy:  context:  c  =  _inputBuffer[_inputPtr++];  }  if  (intLen  ==  0)  {  return  _handleInvalidNumberStart(c,  neg);  }  int  fractLen  =  0;  if  (c  ==  '.')  {  //  yes,  fraction  outBuf[outPtr++]  =  c;  fract_loop:  while  (true)  {  if  (_inputPtr  >=  _inputEnd  &&  !loadMore())  {  eof  =  true;  	if  (outPtr  >=  outBuf.length)  {  outBuf  =  _textBuffer.finishCurrentSegment();  outPtr  =  0;  }  	1418	add
304	Compress_44	buggy:  context:  public  class  ChecksumCalculatingInputStream  extends  InputStream  {  private  final  InputStream  in;  private  final  Checksum  checksum;  public  ChecksumCalculatingInputStream(final  Checksum  checksum,  final  InputStream  in)  {  this.checksum  =  checksum;  this.in  =  in;  	if  (  checksum  ==  null  ){  throw  new  NullPointerException( "Parameter  checksum  must  not  be  null ");  }  if  (  in  ==  null  ){  throw  new  NullPointerException( "Parameter  in  must  not  be  null ");  }  	35	add
464	JacksonDatabind_96	buggy:  paramName  =  candidate.findImplicitParamName(0);  context:  boolean  useProps  =  (paramName  !=  null)  ||  (injectId  !=  null);  if  (!useProps  &&  (paramDef  !=  null))  {      paramName  =  candidate.findImplicitParamName(0);  useProps  =  (paramName  !=  null)  &&  paramDef.couldSerialize();  }  if  (useProps)  {  SettableBeanProperty[]  properties  =  new  SettableBeanProperty[]  {  constructCreatorProperty(ctxt,  beanDesc,  paramName,  0,  param,  injectId)  };  creators.addPropertyCreator(candidate.creator(),  true,  properties);  return;  	paramName  =  candidate.paramName(0);  	735	replace-1
273	Compress_13	buggy:  context:  public  boolean  isDirectory()  {  return  getName().endsWith( "/ ");  }  protected  void  setName(String  name)  {  this.name  =  name;  }  	if  (name  !=  null  &&  getPlatform()  ==  PLATFORM_FAT  &&  name.indexOf( "/ ")  ==  -1)  {  name  =  name.replace('\\',  '/');  }  	512	add
268	Compress_8	buggy:  boolean  stillPadding  =  true;  final  byte  currentByte  =  buffer[i];  if  (currentByte  ==  0)  {  if  (currentByte  ==  (byte)  '  '  ||  currentByte  ==  '0')  {  if  (stillPadding)  {  continue;  }  if  (currentByte  ==  (byte)  '  ')  {  }  stillPadding  =  false;  context:  public  static  long  parseOctal(final  byte[]  buffer,  final  int  offset,  final  int  length)  {  long    result  =  0;      boolean  stillPadding  =  true;  int  end  =  offset  +  length;  int  start  =  offset;  for  (int  i  =  start;  i  <  end;  i++){  	if  (length  <  2){  throw  new  IllegalArgumentException( "Length   "+length+ "  must  be  at  least  2 ");  }    boolean  allNUL  =  true;  if  (buffer[i]  !=  0){  allNUL  =  false;  }  if  (allNUL)  {  return  0L;  }  while  (start  <  end){  if  (buffer[start]  ==  '  '){  start++;  }  else  {  }  byte  trailer;  trailer  =  buffer[end-1];  if  (trailer  ==  0  ||  trailer  ==  '  '){  end--;  }  else  {  throw  new  IllegalArgumentException(  exceptionMessage(buffer,  offset,  length,  end-1,  trailer));  }  trailer  =  buffer[end-1];  if  (trailer  ==  0  ||  trailer  ==  '  '){  end--;  }  for  (  ;start  <  end;  start++)  {  final  byte  currentByte  =  buffer[start];  	53	replace-10
278	Compress_18	buggy:  context:  }  }  void  writePaxHeaders(String  entryName,  Map<String,  String>  headers)  throws  IOException  {  String  name  =   "./PaxHeaders.X/ "  +  stripTo7Bits(entryName);  if  (name.length()  >=  TarConstants.NAMELEN)  {  name  =  name.substring(0,  TarConstants.NAMELEN  -  1);  }  TarArchiveEntry  pex  =  new  TarArchiveEntry(name,  TarConstants.LF_PAX_EXTENDED_HEADER_LC);  	while  (name.endsWith( "/ "))  {  name  =  name.substring(0,  name.length()  -  1);  }  	457	add
393	JacksonDatabind_25	buggy:  type  =  (T)  type.narrowBy(subclass);  context:  protected  <T  extends  JavaType>  T  modifyTypeByAnnotation(DeserializationContext  ctxt,  Annotated  a,  T  type)  throws  JsonMappingException  {  AnnotationIntrospector  intr  =  ctxt.getAnnotationIntrospector();  Class<?>  subclass  =  intr.findDeserializationType(a,  type);  if  (subclass  !=  null)  {  try  {      type  =  (T)  type.narrowBy(subclass);  }  catch  (IllegalArgumentException  iae)  {  throw  new  JsonMappingException( "Failed  to  narrow  type   "+type+ "  with  concrete-type  annotation  (value   "+subclass.getName()+ "),  method  ' "+a.getName()+ "':   "+iae.getMessage(),  null,  iae);  }  }  if  (type.isContainerType())  {  Class<?>  keyClass  =  intr.findDeserializationKeyType(a,  type.getKeyType());  	type  =  (T)  ctxt.getTypeFactory().constructSpecializedType(type,  subclass);  	1757	replace-1
41	Cli_16	buggy:  context:  public  void  addOption(Option  option)  {  options.add(option);  nameToOption.put(option.getPreferredName(),  option);  for  (Iterator  i  =  option.getTriggers().iterator();  i.hasNext();)  {  nameToOption.put(i.next(),  option);  }  }  public  void  addValue(final  Option  option,  final  Object  value)  {  if  (option  instanceof  Argument)  {  	Option  parent  =  option.getParent();  while  (parent  !=  null  &&  !options.contains(parent))  {  options.add(parent);  parent  =  parent.getParent();  }  	74	add
499	Jsoup_13	buggy:  context:  }  public  boolean  hasAttr(String  attributeKey)  {  Validate.notNull(attributeKey);  return  attributes.hasKey(attributeKey);  }  	if  (attributeKey.toLowerCase().startsWith( "abs: "))  {  String  key  =  attributeKey.substring( "abs: ".length());  if  (attributes.hasKey(key)  &&  !absUrl(key).equals( " "))  return  true;  }  	107	add
30	Cli_4	buggy:  StringBuffer  buff  =  new  StringBuffer();  context:  private  void  checkRequiredOptions()  throws  MissingOptionException  {  if  (requiredOptions.size()  >  0)  {  Iterator  iter  =  requiredOptions.iterator();      StringBuffer  buff  =  new  StringBuffer();  while  (iter.hasNext())  {  buff.append(iter.next());  	StringBuffer  buff  =  new  StringBuffer( "Missing  required  option ");  buff.append(requiredOptions.size()  ==  1  ?   " "  :   "s ");  buff.append( ":   ");  	298	replace-1
440	JacksonDatabind_72	buggy:  }  context:  public  InnerClassProperty  withValueDeserializer(JsonDeserializer<?>  deser)  {  return  new  InnerClassProperty(this,  deser);  }  public  void  assignIndex(int  index)  {  _delegate.assignIndex(index);  }  public  int  getPropertyIndex()  {  return  _delegate.getPropertyIndex();  }  public  <A  extends  Annotation>  A  getAnnotation(Class<A>  acls)  {  return  _delegate.getAnnotation(acls);  }  	@Override  public  int  getCreatorIndex()  {  return  _delegate.getCreatorIndex();  }  }  	93	replace-1
348	JacksonCore_6	buggy:  for  (int  i  =  0;  i  <  len;  ++i)  {  char  c  =  str.charAt(i);  context:  private  final  static  int  _parseIndex(String  str)  {  final  int  len  =  str.length();  if  (len  ==  0  ||  len  >  10)  {  return  -1;  }      for  (int  i  =  0;  i  <  len;  ++i)  {      char  c  =  str.charAt(i);  	char  c  =  str.charAt(0);  if  (c  <=  '0')  {  return  (len  ==  1  &&  c  ==  '0')  ?  0  :  -1;  }  if  (c  >  '9')  {  return  -1;  }  for  (int  i  =  1;  i  <  len;  ++i)  {  c  =  str.charAt(i);  	193	replace-2
530	Jsoup_44	buggy:  context:  token.reset();  if  (token.type  ==  Token.TokenType.EOF)  break;  }  }  protected  abstract  boolean  process(Token  token);  protected  boolean  processStartTag(String  name)  {  return  process(start.reset().name(name));  }  public  boolean  processStartTag(String  name,  Attributes  attrs)  {  	if  (currentToken  ==  start)  {  //  don't  recycle  an  in-use  token  return  process(new  Token.StartTag().name(name));  }  if  (currentToken  ==  start)  {  //  don't  recycle  an  in-use  token  return  process(new  Token.StartTag().nameAttr(name,  attrs));  }  if  (currentToken  ==  end)  {  //  don't  recycle  an  in-use  token  return  process(new  Token.EndTag().name(name));  }  	61	add
432	JacksonDatabind_64	buggy:  if  (_useRealPropertyDefaults)  {  valueToSuppress  =  getPropertyDefaultValue(propDef.getName(),  am,  actualType);  context:  inclusion  =  JsonInclude.Include.ALWAYS;  }  switch  (inclusion)  {  case  NON_DEFAULT:      if  (_useRealPropertyDefaults)  {  if  (prov.isEnabled(MapperFeature.CAN_OVERRIDE_ACCESS_MODIFIERS))  {  	Object  defaultBean;  if  (_useRealPropertyDefaults  &&  (defaultBean  =  getDefaultBean())  !=  null)  {  try  {  valueToSuppress  =  am.getValue(defaultBean);  }  catch  (Exception  e)  {  _throwWrapped(e,  propDef.getName(),  defaultBean);  }  	152	replace-2
538	Jsoup_52	buggy:  try  {  if  (Charset.isSupported(meta.attr( "charset ")))  {  }  }  catch  (IllegalCharsetNameException  e)  {  foundCharset  =  null;  }  context:  docData  =  Charset.forName(defaultCharset).decode(byteData).toString();  doc  =  parser.parseInput(docData,  baseUri);  Element  meta  =  doc.select( "meta[http-equiv=content-type],  meta[charset] ").first();  String  foundCharset  =  null;  //  if  not  found,  will  keep  utf-8  as  best  attempt  if  (meta  !=  null)  {  if  (meta.hasAttr( "http-equiv "))  {  foundCharset  =  getCharsetFromContentType(meta.attr( "content "));  }  if  (foundCharset  ==  null  &&  meta.hasAttr( "charset "))  {          try  {          if  (Charset.isSupported(meta.attr( "charset ")))  {  foundCharset  =  meta.attr( "charset ");          }          }  catch  (IllegalCharsetNameException  e)  {          foundCharset  =  null;          }  }  }  		112	remove-6
401	JacksonDatabind_33	buggy:  ||  _hasAnnotation(a,  JsonRawValue.class))  {  context:  }  else  {  JsonProperty  pann  =  _findAnnotation(a,  JsonProperty.class);  if  (pann  !=  null)  {  name  =  pann.value();  }  else  if  (_hasAnnotation(a,  JsonSerialize.class)  ||  _hasAnnotation(a,  JsonView.class)          ||  _hasAnnotation(a,  JsonRawValue.class))  {  name  =   " ";  }  else  {  return  null;  }  }  	||  _hasAnnotation(a,  JsonRawValue.class)  ||  _hasAnnotation(a,  JsonUnwrapped.class)  ||  _hasAnnotation(a,  JsonBackReference.class)  ||  _hasAnnotation(a,  JsonManagedReference.class))  {  	748	replace-1
251	Codec_9	buggy:  long  len  =  getEncodeLength(binaryData,  MIME_CHUNK_SIZE,  CHUNK_SEPARATOR);  context:  public  static  byte[]  encodeBase64(byte[]  binaryData,  boolean  isChunked,  boolean  urlSafe,  int  maxResultSize)  {  if  (binaryData  ==  null  ||  binaryData.length  ==  0)  {  return  binaryData;  }      long  len  =  getEncodeLength(binaryData,  MIME_CHUNK_SIZE,  CHUNK_SEPARATOR);  if  (len  >  maxResultSize)  {  throw  new  IllegalArgumentException( "Input  array  too  big,  the  output  array  would  be  bigger  ( "  +  len  +   ")  than  the  specified  maxium  size  of   "  +  maxResultSize);  }  Base64  b64  =  isChunked  ?  new  Base64(urlSafe)  :  new  Base64(0,  CHUNK_SEPARATOR,  urlSafe);  	long  len  =  getEncodeLength(binaryData,  isChunked  ?  MIME_CHUNK_SIZE  :  0,  CHUNK_SEPARATOR);  	827	replace-1
491	Jsoup_5	buggy:  tq.consume();  context:  while  (!tq.matchesAny( "< ",   "/> ",   "> ")  &&  !tq.matchesWhitespace()  &&  !tq.isEmpty())  {  valueAccum.append(tq.consume());  }  value  =  valueAccum.toString();  }  tq.consumeWhitespace();  }  if  (key.length()  !=  0)  return  Attribute.createFromEncoded(key,  value);  else  {      tq.consume();  return  null;  }  }  private  void  parseTextNode()  {  TextNode  textNode;  	if  (value.length()  ==  0)  //  no  key,  no  val;  unknown  char,  keep  popping  so  not  get  stuck  tq.advance();  	206	replace-1
416	JacksonDatabind_48	buggy:  context:  public  VisibilityChecker<?>  getDefaultVisibilityChecker()  {  VisibilityChecker<?>  vchecker  =  super.getDefaultVisibilityChecker();  if  (!isEnabled(MapperFeature.AUTO_DETECT_SETTERS))  {  vchecker  =  vchecker.withSetterVisibility(Visibility.NONE);  }  if  (!isEnabled(MapperFeature.AUTO_DETECT_CREATORS))  {  vchecker  =  vchecker.withCreatorVisibility(Visibility.NONE);  }  if  (!isEnabled(MapperFeature.AUTO_DETECT_FIELDS))  {  vchecker  =  vchecker.withFieldVisibility(Visibility.NONE);  }  return  vchecker;  	if  (!isEnabled(MapperFeature.AUTO_DETECT_GETTERS))  {  vchecker  =  vchecker.withGetterVisibility(Visibility.NONE);  }  if  (!isEnabled(MapperFeature.AUTO_DETECT_IS_GETTERS))  {  vchecker  =  vchecker.withIsGetterVisibility(Visibility.NONE);  }  	780	add
577	Jsoup_91	buggy:  context:  package  org.jsoup;  public  class  UncheckedIOException  extends  RuntimeException  {  public  UncheckedIOException(IOException  cause)  {  super(cause);  }  public  IOException  ioException()  {  return  (IOException)  getCause();  }  }  	public  UncheckedIOException(String  message)  {  super(new  IOException(message));  }  	10	add
369	JacksonDatabind_1	buggy:  context:  public  void  serializeAsColumn(Object  bean,  JsonGenerator  jgen,  SerializerProvider  prov)  throws  Exception  {  Object  value  =  get(bean);  if  (value  ==  null)  {  //  nulls  need  specialized  handling  if  (_nullSerializer  !=  null)  {  _nullSerializer.serialize(null,  jgen,  prov);  }  else  {  //  can  NOT  suppress  entries  in  tabular  output  jgen.writeNull();  }  }  JsonSerializer<Object>  ser  =  _serializer;  if  (ser  ==  null)  {  Class<?>  cls  =  value.getClass();  PropertySerializerMap  map  =  _dynamicSerializers;  ser  =  map.serializerFor(cls);  if  (ser  ==  null)  {  ser  =  _findAndAddDynamic(map,  cls,  prov);  	return;  	592	add
554	Jsoup_68	buggy:  int  bottom  =  stack.size()  -1;  if  (bottom  >  MaxScopeSearchDepth)  {  bottom  =  MaxScopeSearchDepth;  }  context:  private  String[]  specificScopeTarget  =  {null};  private  boolean  inSpecificScope(String  targetName,  String[]  baseTypes,  String[]  extraTypes)  {  specificScopeTarget[0]  =  targetName;  return  inSpecificScope(specificScopeTarget,  baseTypes,  extraTypes);  }  private  boolean  inSpecificScope(String[]  targetNames,  String[]  baseTypes,  String[]  extraTypes)  {      int  bottom  =  stack.size()  -1;      if  (bottom  >  MaxScopeSearchDepth)  {      bottom  =  MaxScopeSearchDepth;      }  final  int  top  =  bottom  >  MaxScopeSearchDepth  ?  bottom  -  MaxScopeSearchDepth  :  0;  for  (int  pos  =  bottom;  pos  >=  top;  pos--)  {  final  String  elName  =  stack.get(pos).nodeName();  	final  int  bottom  =  stack.size()  -1;  	468	replace-4
33	Cli_8	buggy:  pos  =  findWrapPos(text,  width,  nextLineTabStop);  context:  }  sb.append(rtrim(text.substring(0,  pos))).append(defaultNewLine);  final  String  padding  =  createPadding(nextLineTabStop);  while  (true)  {  text  =  padding  +  text.substring(pos).trim();      pos  =  findWrapPos(text,  width,  nextLineTabStop);  if  (pos  ==  -1)  {  sb.append(text);  return  sb;  }  	pos  =  findWrapPos(text,  width,  0);  	812	replace-1
318	Csv_11	buggy:  final  boolean  emptyHeader  =  header.trim().isEmpty();  context:  this.nextRecord();  }  headerRecord  =  formatHeader;  }  if  (headerRecord  !=  null)  {  for  (int  i  =  0;  i  <  headerRecord.length;  i++)  {  final  String  header  =  headerRecord[i];  final  boolean  containsHeader  =  hdrMap.containsKey(header);          final  boolean  emptyHeader  =  header.trim().isEmpty();  if  (containsHeader  &&  (!emptyHeader  ||  (emptyHeader  &&  !this.format.getIgnoreEmptyHeaders())))  {  throw  new  IllegalArgumentException( "The  header  contains  a  duplicate  name:  \ " "  +  header  +   "\ "  in   "  +  Arrays.toString(headerRecord));  }  hdrMap.put(header,  Integer.valueOf(i));  }  }  }  	final  boolean  emptyHeader  =  header  ==  null  ||  header.trim().isEmpty();  	384	replace-1
274	Compress_14	buggy:  boolean  allNUL  =  true;  for  (int  i  =  start;  i  <  end;  i++){  if  (buffer[i]  !=  0){  allNUL  =  false;  break;  }  }  if  (allNUL)  {  context:  public  static  long  parseOctal(final  byte[]  buffer,  final  int  offset,  final  int  length)  {  long    result  =  0;  int  end  =  offset  +  length;  int  start  =  offset;  if  (length  <  2){  throw  new  IllegalArgumentException( "Length   "+length+ "  must  be  at  least  2 ");  }      boolean  allNUL  =  true;      for  (int  i  =  start;  i  <  end;  i++){      if  (buffer[i]  !=  0){      allNUL  =  false;      break;      }      }      if  (allNUL)  {  return  0L;  	if  (buffer[start]  ==  0)  {  	65	replace-8
459	JacksonDatabind_91	buggy:  return  (ct.getValueHandler()  !=  null)  ||  (ct.getTypeHandler()  !=  null);  context:  private  boolean  _hasCustomHandlers(JavaType  t)  {  if  (t.isContainerType())  {  JavaType  ct  =  t.getContentType();  if  (ct  !=  null)  {      return  (ct.getValueHandler()  !=  null)  ||  (ct.getTypeHandler()  !=  null);  	if  ((ct.getValueHandler()  !=  null)  ||  (ct.getTypeHandler()  !=  null))  {  return  true;  }  }  if  (t.isMapLikeType())  {  JavaType  kt  =  t.getKeyType();  if  (kt.getValueHandler()  !=  null)  {  return  true;  }  	541	replace-1
534	Jsoup_48	buggy:  if  (!values.isEmpty())  context:  continue;  TokenQueue  cd  =  new  TokenQueue(value);  String  cookieName  =  cd.chompTo( "= ").trim();  String  cookieVal  =  cd.consumeTo( "; ").trim();  if  (cookieName.length()  >  0)  cookie(cookieName,  cookieVal);  }  }  else  {  //  combine  same  header  names  with  comma:  http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.2          if  (!values.isEmpty())  header(name,  values.get(0));  	if  (values.size()  ==  1)  else  if  (values.size()  >  1)  {  StringBuilder  accum  =  new  StringBuilder();  for  (int  i  =  0;  i  <  values.size();  i++)  {  final  String  val  =  values.get(i);  if  (i  !=  0)  accum.append( ",   ");  accum.append(val);  }  header(name,  accum.toString());  }  	773	replace-1
584	JxPath_5	buggy:  throw  new  JXPathException(   "Cannot  compare  pointers  that  do  not  belong  to  the  same  tree:  ' "  +  p1  +   "'  and  ' "  +  p2  +   "' ");  context:  }  if  (p1  ==  null  &&  p2  ==  null)  {  return  0;  }  if  (p1  !=  null  &&  p1.equals(p2))  {  return  0;  }  if  (depth1  ==  1)  {      throw  new  JXPathException(           "Cannot  compare  pointers  that  do  not  belong  to  the  same  tree:  ' "          +  p1  +   "'  and  ' "  +  p2  +   "' ");  }  int  r  =  compareNodePointers(p1.parent,  depth1  -  1,  p2.parent,  depth2  -  1);  if  (r  !=  0)  {  return  r;  }  	return  0;  	665	replace-3
247	Codec_5	buggy:  context:  }  }  }  }  }  if  (eof  &&  modulus  !=  0)  {  x  =  x  <<  6;  switch  (modulus)  {  case  2  :  x  =  x  <<  6;  buffer[pos++]  =  (byte)  ((x  >>  16)  &  MASK_8BITS);  break;  	if  (buffer  ==  null  ||  buffer.length  -  pos  <  decodeSize)  {  resizeBuffer();  }  	586	add
495	Jsoup_9	buggy:  private  static  final  Pattern  unescapePattern  =  Pattern.compile( "&(#(x|X)?([0-9a-fA-F]+)|[a-zA-Z]+);? ");  context:  public  Map<Character,  String>  getMap()  {  return  map;  }  }  private  static  final  Map<String,  Character>  full;  private  static  final  Map<Character,  String>  xhtmlByVal;  private  static  final  Map<Character,  String>  baseByVal;  private  static  final  Map<Character,  String>  fullByVal;  private  static  final  Pattern  unescapePattern  =  Pattern.compile( "&(#(x|X)?([0-9a-fA-F]+)|[a-zA-Z]+);? ");  static  String  escape(String  string,  Document.OutputSettings  out)  {  return  escape(string,  out.encoder(),  out.escapeMode());  }  static  String  escape(String  string,  CharsetEncoder  encoder,  EscapeMode  escapeMode)  {  StringBuilder  accum  =  new  StringBuilder(string.length()  *  2);  Map<Character,  String>  map  =  escapeMode.getMap();  	private  static  final  Pattern  unescapePattern  =  Pattern.compile( "&(#(x|X)?([0-9a-fA-F]+)|[a-zA-Z]+\\d*);? ");  	38	replace-1
558	Jsoup_72	buggy:  context:  private  static  String  cacheString(final  char[]  charBuf,  final  String[]  stringCache,  final  int  start,  final  int  count)  {  if  (count  >  maxStringCacheLen)  return  new  String(charBuf,  start,  count);  int  hash  =  0;  int  offset  =  start;  for  (int  i  =  0;  i  <  count;  i++)  {  hash  =  31  *  hash  +  charBuf[offset++];  }  	if  (count  <  1)  return   " ";  	427	add
412	JacksonDatabind_44	buggy:  context:  protected  JavaType  _narrow(Class<?>  subclass)  {  if  (_class  ==  subclass)  {  return  this;  }  throw  new  IllegalArgumentException( "Class   "+subclass.getName()+ "  not  sub-type  of   "  return  new  SimpleType(subclass,  _bindings,  this,  _superInterfaces,  _valueHandler,  _typeHandler,  _asStatic);  	if  (!_class.isAssignableFrom(subclass))  {  }  Class<?>  next  =  subclass.getSuperclass();  if  (next  ==  _class)  {  //  straight  up  parent  class?  Great.  return  new  SimpleType(subclass,  _bindings,  this,  _superInterfaces,  _valueHandler,  _typeHandler,  _asStatic);  }  if  ((next  !=  null)  &&  _class.isAssignableFrom(next))  {  JavaType  superb  =  _narrow(next);  return  new  SimpleType(subclass,  _bindings,  superb,  null,  _valueHandler,  _typeHandler,  _asStatic);  }  Class<?>[]  nextI  =  subclass.getInterfaces();  for  (Class<?>  iface  :  nextI)  {  if  (iface  ==  _class)  {  //  directly  implemented  return  new  SimpleType(subclass,  _bindings,  null,  new  JavaType[]  {  this  },  _valueHandler,  _typeHandler,  _asStatic);  }  if  (_class.isAssignableFrom(iface))  {  //  indirect,  so  recurse  JavaType  superb  =  _narrow(iface);  return  new  SimpleType(subclass,  _bindings,  null,  new  JavaType[]  {  superb  },  _valueHandler,  _typeHandler,  _asStatic);  }  }  throw  new  IllegalArgumentException( "Internal  error:  Can  not  resolve  sub-type  for  Class   "+subclass.getName()+ "  to   "  +_class.getName());  	132	add
335	Gson_11	buggy:  context:  public  static  final  TypeAdapter<Number>  NUMBER  =  new  TypeAdapter<Number>()  {  public  Number  read(JsonReader  in)  throws  IOException  {  JsonToken  jsonToken  =  in.peek();  switch  (jsonToken)  {  case  NULL:  in.nextNull();  return  null;  case  NUMBER:  return  new  LazilyParsedNumber(in.nextString());  default:  throw  new  JsonSyntaxException( "Expecting  number,  got:   "  +  jsonToken);  }  }  public  void  write(JsonWriter  out,  Number  value)  throws  IOException  {  out.value(value);  }  	case  STRING:  	371	add
511	Jsoup_25	buggy:  private  static  final  String[]  preserveWhitespaceTags  =  { "pre ",   "plaintext ",   "title "};  context:   "option ",   "legend ",   "datalist ",   "keygen ",   "output ",   "progress ",   "meter ",   "area ",   "param ",   "source ",   "track ",   "summary ",   "command ",   "device "  };  private  static  final  String[]  emptyTags  =  {   "meta ",   "link ",   "base ",   "frame ",   "img ",   "br ",   "wbr ",   "embed ",   "hr ",   "input ",   "keygen ",   "col ",   "command ",   "device "  };  private  static  final  String[]  formatAsInlineTags  =  {   "title ",   "a ",   "p ",   "h1 ",   "h2 ",   "h3 ",   "h4 ",   "h5 ",   "h6 ",   "pre ",   "address ",   "li ",   "th ",   "td ",   "script ",   "style "  };  private  static  final  String[]  preserveWhitespaceTags  =  { "pre ",   "plaintext ",   "title "};  static  {  for  (String  tagName  :  blockTags)  {  Tag  tag  =  new  Tag(tagName);  register(tag);  }  for  (String  tagName  :  inlineTags)  {  	private  static  final  String[]  preserveWhitespaceTags  =  { "pre ",   "plaintext ",   "title ",   "textarea "};  	218	replace-1
45	Cli_20	buggy:  if  (token.indexOf('=')  !=  -1)  tokens.add(token.substring(0,  token.indexOf('=')));  tokens.add(token.substring(token.indexOf('=')  +  1,  token.length()));  tokens.add(token);  context:  while  (iter.hasNext())  {  String  token  =  (String)  iter.next();  if  (token.startsWith( "-- "))  {      if  (token.indexOf('=')  !=  -1)  {          tokens.add(token.substring(0,  token.indexOf('=')));          tokens.add(token.substring(token.indexOf('=')  +  1,  token.length()));  }  	int  pos  =  token.indexOf('=');  String  opt  =  pos  ==  -1  ?  token  :  token.substring(0,  pos);  //  --foo    if  (!options.hasOption(opt)  &&  stopAtNonOption)  process(token);  tokens.add(opt);  if  (pos  !=  -1)  {  tokens.add(token.substring(pos  +  1));  }  	114	replace-4
381	JacksonDatabind_13	buggy:  context:  public  ReadableObjectId  findObjectId(Object  id,  ObjectIdGenerator<?>  gen,  ObjectIdResolver  resolverType)  {  final  ObjectIdGenerator.IdKey  key  =  gen.key(id);  if  (_objectIds  ==  null)  {  _objectIds  =  new  LinkedHashMap<ObjectIdGenerator.IdKey,ReadableObjectId>();  }  else  {  ReadableObjectId  entry  =  _objectIds.get(key);  	if  (id  ==  null)  {  return  null;  }  	87	add
519	Jsoup_33	buggy:  context:  if  (errors.canAddError())  errors.add(new  ParseError(reader.pos(),   "Unexpected  token  [%s]  when  in  state  [%s] ",  currentToken.tokenType(),  state));  }  Element  insert(Token.StartTag  startTag)  {  if  (startTag.isSelfClosing())  {  Element  el  =  insertEmpty(startTag);  stack.add(el);  tokeniser.emit(new  Token.EndTag(el.tagName()));  //  ensure  we  get  out  of  whatever  state  we  are  in.  emitted  for  yielded  processing  return  el;  }  Element  el  =  new  Element(Tag.valueOf(startTag.name()),  baseUri,  startTag.attributes);  insert(el);  return  el;  }  	tokeniser.transition(TokeniserState.Data);  //  handles  <script  />,  otherwise  needs  breakout  steps  from  script  data  	162	add
298	Compress_38	buggy:  if  (getName().endsWith( "/ "))  {  context:  public  boolean  isDirectory()  {  if  (file  !=  null)  {  return  file.isDirectory();  }  if  (linkFlag  ==  LF_DIR)  {  return  true;  }      if  (getName().endsWith( "/ "))  {  return  true;  }  return  false;  }  	if  (!isPaxHeader()  &&  !isGlobalPaxHeader()  &&  getName().endsWith( "/ "))  {  	859	replace-1
550	Jsoup_64	buggy:  tb.insert(startTag);  context:  }  private  static  void  handleRcData(Token.StartTag  startTag,  HtmlTreeBuilder  tb)  {  tb.tokeniser.transition(TokeniserState.Rcdata);  tb.markInsertionMode();  tb.transition(Text);  tb.insert(startTag);  }  private  static  void  handleRawtext(Token.StartTag  startTag,  HtmlTreeBuilder  tb)  {      tb.insert(startTag);  tb.tokeniser.transition(TokeniserState.Rawtext);  tb.markInsertionMode();  tb.transition(Text);  }  private  static  final  class  Constants  {  	tb.insert(startTag);  	1489	replace-1
420	JacksonDatabind_52	buggy:  _externalTypeIdHandler  =  extTypes.build();  context:  }  if  (creatorProps  !=  null)  {  _propertyBasedCreator  =  PropertyBasedCreator.construct(ctxt,  _valueInstantiator,  creatorProps);  }  if  (extTypes  !=  null)  {      _externalTypeIdHandler  =  extTypes.build();  _nonStandardCreation  =  true;  }  _unwrappedPropertyHandler  =  unwrapped;  if  (unwrapped  !=  null)  {  //  we  consider  this  non-standard,  to  offline  handling  _nonStandardCreation  =  true;  }  	_externalTypeIdHandler  =  extTypes.build(_beanProperties);  	612	replace-1
551	Jsoup_65	buggy:  clearStackToContext( "tbody ",   "tfoot ",   "thead ");  clearStackToContext( "tr ");  context:  stack.remove(pos);  }  }  }  void  clearStackToTableContext()  {  clearStackToContext( "table ");  }  void  clearStackToTableBodyContext()  {      clearStackToContext( "tbody ",   "tfoot ",   "thead ");  }  void  clearStackToTableRowContext()  {      clearStackToContext( "tr ");  }  private  void  clearStackToContext(String...  nodeNames)  {  	clearStackToContext( "tbody ",   "tfoot ",   "thead ",   "template ");  clearStackToContext( "tr ",   "template ");  	360	replace-2
589	JxPath_10	buggy:  return  compute(args[0].computeValue(context),  args[1].computeValue(context))  context:  public  abstract  class  CoreOperationRelationalExpression  extends  CoreOperation  {  protected  CoreOperationRelationalExpression(Expression[]  args)  {  super(args);  }  public  final  Object  computeValue(EvalContext  context)  {      return  compute(args[0].computeValue(context),  args[1].computeValue(context))  ?  Boolean.TRUE  :  Boolean.FALSE;  }  protected  final  int  getPrecedence()  {  return  3;  }  protected  final  boolean  isSymmetric()  {  	return  compute(args[0].compute(context),  args[1].compute(context))  	42	replace-1
470	JacksonDatabind_102	buggy:  if  (property  ==  null)  {  return  this;  }  context:  }  public  abstract  DateTimeSerializerBase<T>  withFormat(Boolean  timestamp,  DateFormat  customFormat);  public  JsonSerializer<?>  createContextual(SerializerProvider  serializers,  BeanProperty  property)  throws  JsonMappingException  {      if  (property  ==  null)  {      return  this;      }  JsonFormat.Value  format  =  findFormatOverrides(serializers,  property,  handledType());  if  (format  ==  null)  {  return  this;  }  JsonFormat.Shape  shape  =  format.getShape();  if  (shape.isNumeric())  {  		67	remove-3
367	JacksonCore_25	buggy:  if  (i  <=  maxCode)  {  context:  final  int  maxCode  =  codes.length;  while  (true)  {  if  (_inputPtr  >=  _inputEnd)  {  if  (!_loadMore())  {  //  acceptable  for  now  (will  error  out  later)  break;  }  }  char  c  =  _inputBuffer[_inputPtr];  int  i  =  (int)  c;      if  (i  <=  maxCode)  {  if  (codes[i]  !=  0)  {  break;  }  }  else  if  (!Character.isJavaIdentifierPart(c))  {  break;  }  hash  =  (hash  *  CharsToNameCanonicalizer.HASH_MULT)  +  i;  	if  (i  <  maxCode)  {  	1963	replace-1
62	Cli_37	buggy:  return  token.startsWith( "- ")  &&  token.length()  >=  2  &&  options.hasShortOption(token.substring(1,  2));  context:  }  private  boolean  isShortOption(String  token)  {      return  token.startsWith( "- ")  &&  token.length()  >=  2  &&  options.hasShortOption(token.substring(1,  2));  	if  (!token.startsWith( "- ")  ||  token.length()  ==  1)  {  return  false;  }  int  pos  =  token.indexOf( "= ");  String  optName  =  pos  ==  -1  ?  token.substring(1)  :  token.substring(1,  pos);  return  options.hasShortOption(optName);  	302	replace-1
518	Jsoup_32	buggy:  clone.classNames();  context:  public  int  hashCode()  {  int  result  =  super.hashCode();  result  =  31  *  result  +  (tag  !=  null  ?  tag.hashCode()  :  0);  return  result;  }  public  Element  clone()  {  Element  clone  =  (Element)  super.clone();      clone.classNames();  return  clone;  }  }  	clone.classNames  =  null;  //  derived  on  first  hit,  otherwise  gets  a  pointer  to  source  classnames  	1138	replace-1
510	Jsoup_24	buggy:  r.advance();  context:  t.transition(ScriptDataEscaped);  }  }  },  ScriptDataEscapedEndTagName  {  void  read(Tokeniser  t,  CharacterReader  r)  {  if  (r.matchesLetter())  {  String  name  =  r.consumeLetterSequence();  t.tagPending.appendTagName(name.toLowerCase());  t.dataBuffer.append(name);      r.advance();  return;  }  if  (t.isAppropriateEndTagToken()  &&  !r.isEmpty())  {  char  c  =  r.consume();  switch  (c)  {  case  '\t':  case  '\n':  case  '\f':  		558	remove-1
380	JacksonDatabind_12	buggy:  return  (_valueTypeDeserializer  ==  null)  context:  public  boolean  isCachable()  {      return  (_valueTypeDeserializer  ==  null)  &&  (_ignorableProperties  ==  null);  }  public  Map<Object,Object>  deserialize(JsonParser  jp,  DeserializationContext  ctxt)  	return  (_valueDeserializer  ==  null)  &&  (_keyDeserializer  ==  null)  &&  (_valueTypeDeserializer  ==  null)  	303	replace-1
334	Gson_10	buggy:  TypeAdapter  t  =  new  TypeAdapterRuntimeTypeWrapper(context,  typeAdapter,  fieldType.getType());  context:  }  final  boolean  jsonAdapterPresent  =  mapped  !=  null;  if  (mapped  ==  null)  mapped  =  context.getAdapter(fieldType);  final  TypeAdapter<?>  typeAdapter  =  mapped;  return  new  ReflectiveTypeAdapterFactory.BoundField(name,  serialize,  deserialize)  {  throws  IOException,  IllegalAccessException  {  Object  fieldValue  =  field.get(value);      TypeAdapter  t  =    new  TypeAdapterRuntimeTypeWrapper(context,  typeAdapter,  fieldType.getType());  t.write(writer,  fieldValue);  }  throws  IOException,  IllegalAccessException  {  Object  fieldValue  =  typeAdapter.read(reader);  if  (fieldValue  !=  null  ||  !isPrimitive)  {  	TypeAdapter  t  =  jsonAdapterPresent  ?  typeAdapter  :  new  TypeAdapterRuntimeTypeWrapper(context,  typeAdapter,  fieldType.getType());  	122	replace-2
494	Jsoup_8	buggy:  new  NodeTraversor(new  OuterHtmlVisitor(accum,  ownerDocument().outputSettings())).traverse(this);  context:  Get  the  outer  HTML  of  this  node.  public  String  outerHtml()  {  StringBuilder  accum  =  new  StringBuilder(32*1024);  outerHtml(accum);  return  accum.toString();  }  protected  void  outerHtml(StringBuilder  accum)  {      new  NodeTraversor(new  OuterHtmlVisitor(accum,  ownerDocument().outputSettings())).traverse(this);  }  	new  NodeTraversor(new  OuterHtmlVisitor(accum,  getOutputSettings())).traverse(this);  private  Document.OutputSettings  getOutputSettings()  {  return  ownerDocument()  !=  null  ?  ownerDocument().outputSettings()  :  (new  Document( " ")).outputSettings();  }  	363	replace-1
413	JacksonDatabind_45	buggy:  if  (format.getShape()  ==  JsonFormat.Shape.STRING)  {  context:  if  (property  !=  null)  {  JsonFormat.Value  format  =  serializers.getAnnotationIntrospector().findFormat((Annotated)property.getMember());  if  (format  !=  null)  {  JsonFormat.Shape  shape  =  format.getShape();  if  (shape.isNumeric())  {  return  withFormat(Boolean.TRUE,  null);  }      if  (format.getShape()  ==  JsonFormat.Shape.STRING)  {  TimeZone  tz  =  format.getTimeZone();  final  String  pattern  =  format.hasPattern()  ?  format.getPattern()  :  StdDateFormat.DATE_FORMAT_STR_ISO8601;  final  Locale  loc  =  format.hasLocale()  ?  format.getLocale()  :  serializers.getLocale();  	if  ((shape  ==  JsonFormat.Shape.STRING)  ||  format.hasPattern()  ||  format.hasLocale()  ||  format.hasTimeZone())  {  	63	replace-1
246	Codec_4	buggy:  this(false);  context:  public  Base64()  {      this(false);  }  	this(0);  	225	replace-1
308	Csv_1	buggy:  if  (current  ==  '\n')  {  context:  ExtendedBufferedReader(Reader  r)  {  super(r);  }  public  int  read()  throws  IOException  {  int  current  =  super.read();      if  (current  ==  '\n')  {  lineCounter++;  }  lastChar  =  current;  return  lastChar;  }  	if  (current  ==  '\r'  ||  (current  ==  '\n'  &&  lastChar  !=  '\r'))  {  	58	replace-1
454	JacksonDatabind_86	buggy:  context:  public  void  setReference(JavaType  ref)  {  if  (_referencedType  !=  null)  {  throw  new  IllegalStateException( "Trying  to  re-set  self  reference;  old  value  =   "+_referencedType+ ",  new  =   "+ref);  }  _referencedType  =  ref;  }  public  JavaType  getSelfReferencedType()  {  return  _referencedType;  }  	@Override  public  JavaType  getSuperClass()  {  if  (_referencedType  !=  null)  {  return  _referencedType.getSuperClass();  }  return  super.getSuperClass();  }  	29	add
302	Compress_42	buggy:  return  (getUnixMode()  &  UnixStat.LINK_FLAG)  ==  UnixStat.LINK_FLAG;  context:  public  boolean  isUnixSymlink()  {      return  (getUnixMode()  &  UnixStat.LINK_FLAG)  ==  UnixStat.LINK_FLAG;  }  	return  (getUnixMode()  &  UnixStat.FILE_TYPE_FLAG)  ==  UnixStat.LINK_FLAG;  	297	replace-1
458	JacksonDatabind_90	buggy:  context:  public  boolean  canCreateUsingArrayDelegate()  {  return  (_arrayDelegateType  !=  null);  }  public  boolean  canCreateFromObjectWith()  {  return  (_withArgsCreator  !=  null);  }  	@Override  public  boolean  canInstantiate()  {  return  canCreateUsingDefault()  ||  canCreateUsingDelegate()  ||  canCreateUsingArrayDelegate()  ||  canCreateFromObjectWith()  ||  canCreateFromString()  ||  canCreateFromInt()  ||  canCreateFromLong()  ||  canCreateFromDouble()  ||  canCreateFromBoolean();  }  	232	add
535	Jsoup_49	buggy:  reindexChildren(index);  context:  }  }  protected  void  addChildren(int  index,  Node...  children)  {  Validate.noNullElements(children);  ensureChildNodes();  for  (int  i  =  children.length  -  1;  i  >=  0;  i--)  {  Node  in  =  children[i];  reparentChild(in);  childNodes.add(index,  in);  }      reindexChildren(index);  }  protected  void  ensureChildNodes()  {  if  (childNodes  ==  EMPTY_NODES)  {  childNodes  =  new  ArrayList<Node>(4);  }  }  	reindexChildren(index);  	445	replace-1
396	JacksonDatabind_28	buggy:  if  (p.getCurrentToken()  ==  JsonToken.START_OBJECT)  {  p.nextToken();  if  (p.getCurrentToken()  ==  JsonToken.FIELD_NAME)  {  return  deserializeObject(p,  ctxt,  ctxt.getNodeFactory());  context:  protected  final  static  ObjectDeserializer  _instance  =  new  ObjectDeserializer();  protected  ObjectDeserializer()  {  super(ObjectNode.class);  }  public  static  ObjectDeserializer  getInstance()  {  return  _instance;  }  public  ObjectNode  deserialize(JsonParser  p,  DeserializationContext  ctxt)  throws  IOException  {      if  (p.getCurrentToken()  ==  JsonToken.START_OBJECT)  {      p.nextToken();  return  deserializeObject(p,  ctxt,  ctxt.getNodeFactory());  }      if  (p.getCurrentToken()  ==  JsonToken.FIELD_NAME)  {      return  deserializeObject(p,  ctxt,  ctxt.getNodeFactory());  	if  (p.isExpectedStartObjectToken()  ||  p.hasToken(JsonToken.FIELD_NAME))  {  if  (p.hasToken(JsonToken.END_OBJECT))  {  return  ctxt.getNodeFactory().objectNode();  	97	replace-4
275	Compress_15	buggy:  if  (otherComment  !=  null)  {  return  false;  }  }  else  if  (!myComment.equals(otherComment))  {  return  false;  context:  if  (myName  ==  null)  {  if  (otherName  !=  null)  {  return  false;  }  }  else  if  (!myName.equals(otherName))  {  return  false;  }  String  myComment  =  getComment();  String  otherComment  =  other.getComment();  if  (myComment  ==  null)  {      if  (otherComment  !=  null)  {      return  false;      }      }  else  if  (!myComment.equals(otherComment))  {      return  false;  }  	myComment  =   " ";  }  if  (otherComment  ==  null)  {  otherComment  =   " ";  &&  myComment.equals(otherComment)  	669	replace-5
34	Cli_9	buggy:  throw  new  MissingOptionException(buff.toString());  context:  Iterator  iter  =  getRequiredOptions().iterator();  StringBuffer  buff  =  new  StringBuffer( "Missing  required  option ");  buff.append(getRequiredOptions().size()  ==  1  ?   " "  :   "s ");  buff.append( ":   ");  while  (iter.hasNext())  {  buff.append(iter.next());  }      throw  new  MissingOptionException(buff.toString());  }  }  	buff.append( ",   ");  throw  new  MissingOptionException(buff.substring(0,  buff.length()  -  2));  	320	replace-1
317	Csv_10	buggy:  context:  public  CSVPrinter(final  Appendable  out,  final  CSVFormat  format)  throws  IOException  {  Assertions.notNull(out,   "out ");  Assertions.notNull(format,   "format ");  this.out  =  out;  this.format  =  format;  this.format.validate();  }  public  void  close()  throws  IOException  {  	if  (format.getHeader()  !=  null)  {  this.printRecord((Object[])  format.getHeader());  }  	70	add
555	Jsoup_69	buggy:  context:  public  FormElement  addElement(Element  element)  {  elements.add(element);  return  this;  }  	@Override  protected  void  removeChild(Node  out)  {  super.removeChild(out);  elements.remove(out);  }  	49	add
572	Jsoup_86	buggy:  if  (doc.childNodeSize()  >  0)  {  context:  }  public  XmlDeclaration  asXmlDeclaration()  {  String  data  =  getData();  Document  doc  =  Jsoup.parse( "< "  +  data.substring(1,  data.length()  -1)  +   "> ",  baseUri(),  Parser.xmlParser());  XmlDeclaration  decl  =  null;      if  (doc.childNodeSize()  >  0)  {  Element  el  =  doc.child(0);  decl  =  new  XmlDeclaration(NodeUtils.parser(doc).settings().normalizeTag(el.tagName()),  data.startsWith( "! "));  decl.attributes().addAll(el.attributes());  }  return  decl;  }  }  	if  (doc.children().size()  >  0)  {  	78	replace-1
283	Compress_23	buggy:  dictSize  |=  (coder.properties[i  +  1]  <<  (8  *  i));  context:  }  }  static  class  LZMADecoder  extends  CoderBase  {  InputStream  decode(final  InputStream  in,  final  Coder  coder,  byte[]  password)  throws  IOException  {  byte  propsByte  =  coder.properties[0];  long  dictSize  =  coder.properties[1];  for  (int  i  =  1;  i  <  4;  i++)  {      dictSize  |=  (coder.properties[i  +  1]  <<  (8  *  i));  }  if  (dictSize  >  LZMAInputStream.DICT_SIZE_MAX)  {  throw  new  IOException( "Dictionary  larger  than  4GiB  maximum  size ");  }  return  new  LZMAInputStream(in,  -1,  propsByte,  (int)  dictSize);  }  }  	dictSize  |=  (coder.properties[i  +  1]  &  0xffl)  <<  (8  *  i);  	112	replace-1
417	JacksonDatabind_49	buggy:  context:  }  return  true;  }  return  false;  }  public  Object  generateId(Object  forPojo)  {  id  =  generator.generateId(forPojo);  return  id;  }  public  void  writeAsField(JsonGenerator  gen,  SerializerProvider  provider,  	if  (id  ==  null)  {  }  	50	add
576	Jsoup_90	buggy:  context:  if  ((o  &  0xE0)  ==  0xC0)  {  end  =  i  +  1;  }  else  if  ((o  &  0xF0)  ==  0xE0)  {  end  =  i  +  2;  }  else  if  ((o  &  0xF8)  ==  0xF0)  {  end  =  i  +  3;  }  else  {  return  false;  }  while  (i  <  end)  {  i++;  o  =  input[i];  if  ((o  &  0xC0)  !=  0x80)  {  return  false;  }  }  	if  (end  >=  input.length)  return  false;  	424	add
250	Codec_8	buggy:  if  (c  >  0  &&  b.length  ==  len)  {  base64.setInitialBuffer(b,  offset,  len);  }  context:  readResults()  call  must  return  0  if  a  large  amount  of  the  data  being  decoded  was  non-base64,  so  this  while-loop  enables  proper  interop  with  InputStreamReader  for  that  scenario.  ----  This  is  a  fix  for  CODEC-101  while  (readLen  ==  0)  {  if  (!base64.hasData())  {  byte[]  buf  =  new  byte[doEncode  ?  4096  :  8192];  int  c  =  in.read(buf);          if  (c  >  0  &&  b.length  ==  len)  {          base64.setInitialBuffer(b,  offset,  len);          }  if  (doEncode)  {  base64.encode(buf,  0,  c);  }  else  {  base64.decode(buf,  0,  c);  }  }  readLen  =  base64.readResults(b,  offset,  len);  		169	remove-3
355	JacksonCore_13	buggy:  context:  public  JsonGenerator  enable(Feature  f)  {  super.enable(f);  if  (f  ==  Feature.QUOTE_FIELD_NAMES)  {  _cfgUnqNames  =  false;  }  return  this;  }  	@Override  public  JsonGenerator  disable(Feature  f)  {  super.disable(f);  if  (f  ==  Feature.QUOTE_FIELD_NAMES)  {  _cfgUnqNames  =  true;  }  return  this;  }  	127	add
587	JxPath_8	buggy:  context:  if  (left  instanceof  Iterator  &&  right  instanceof  Iterator)  {  return  findMatch((Iterator)  left,  (Iterator)  right);  }  if  (left  instanceof  Iterator)  {  return  containsMatch((Iterator)  left,  right);  }  if  (right  instanceof  Iterator)  {  return  containsMatch((Iterator)  right,  left);  }  double  ld  =  InfoSetUtil.doubleValue(left);  double  rd  =  InfoSetUtil.doubleValue(right);  return  evaluateCompare(ld  ==  rd  ?  0  :  ld  <  rd  ?  -1  :  1);  }  	if  (Double.isNaN(ld))  {  return  false;  }  if  (Double.isNaN(rd))  {  return  false;  }  	76	add
433	JacksonDatabind_65	buggy:  return  ctxt.handleWeirdKey(_keyClass,  key,   "not  a  valid  representation,  problem:  %s ",  re.getMessage());  context:  {  if  (key  ==  null)  {  //  is  this  even  legal  call?  return  null;  }  try  {  Object  result  =  _parse(key,  ctxt);  if  (result  !=  null)  {  return  result;  }  }  catch  (Exception  re)  {      return  ctxt.handleWeirdKey(_keyClass,  key,   "not  a  valid  representation,  problem:  %s ",  re.getMessage());  }  if  (_keyClass.isEnum()  &&  ctxt.getConfig().isEnabled(DeserializationFeature.READ_UNKNOWN_ENUM_VALUES_AS_NULL))  {  return  null;  }  return  ctxt.handleWeirdKey(_keyClass,  key,   "not  a  valid  representation ");  }  	return  ctxt.handleWeirdKey(_keyClass,  key,   "not  a  valid  representation,  problem:  (%s)  %s ",  re.getClass().getName(),  re.getMessage());  	128	replace-1
539	Jsoup_53	buggy:  context:  public  String  chompBalanced(char  open,  char  close)  {  int  start  =  -1;  int  end  =  -1;  int  depth  =  0;  char  last  =  0;  do  {  if  (isEmpty())  break;  Character  c  =  consume();  if  (last  ==  0  ||  last  !=  ESC)  {  	boolean  inQuote  =  false;  if  (c.equals('\'')  ||  c.equals(' "')  &&  c  !=  open)  inQuote  =  !inQuote;  if  (inQuote)  continue;  	265	add
349	JacksonCore_7	buggy:  context:  return  (_index  <  0)  ?  STATUS_OK_AS_IS  :  STATUS_OK_AFTER_COMMA;  }  private  final  void  _checkDup(DupDetector  dd,  String  name)  throws  JsonProcessingException  {  if  (dd.isDup(name))  {  throw  new  JsonGenerationException( "Duplicate  field  ' "+name+ "' ");  }  }  public  int  writeValue()  {  if  (_type  ==  TYPE_OBJECT)  {  _gotName  =  false;  return  STATUS_OK_AFTER_COLON;  }  if  (_type  ==  TYPE_ARRAY)  {  	if  (!_gotName)  {  return  STATUS_EXPECT_NAME;  }  	169	add
531	Jsoup_45	buggy:  }  else  if  (( "td ".equals(name)  ||   "td ".equals(name)  &&  !last))  {  context:  for  (int  pos  =  stack.size()  -1;  pos  >=  0;  pos--)  {  Element  node  =  stack.get(pos);  if  (pos  ==  0)  {  last  =  true;  node  =  contextElement;  }  String  name  =  node.nodeName();  if  ( "select ".equals(name))  {  transition(HtmlTreeBuilderState.InSelect);  break;  //  frag      }  else  if  (( "td ".equals(name)  ||   "td ".equals(name)  &&  !last))  {  transition(HtmlTreeBuilderState.InCell);  break;  }  else  if  ( "tr ".equals(name))  {  transition(HtmlTreeBuilderState.InRow);  break;  }  else  if  ( "tbody ".equals(name)  ||   "thead ".equals(name)  ||   "tfoot ".equals(name))  {  transition(HtmlTreeBuilderState.InTableBody);  break;  	}  else  if  (( "td ".equals(name)  ||   "th ".equals(name)  &&  !last))  {  	394	replace-1
0	Cli_40	buggy:  return  null;  context:  else  if  (PatternOptionBuilder.FILES_VALUE  ==  clazz)  {  return  (T)  createFiles(str);  }  else  if  (PatternOptionBuilder.URL_VALUE  ==  clazz)  {  return  (T)  createURL(str);  }  else  {      return  null;  }  }  	throw  new  ParseException( "Unable  to  handle  the  class:   "  +  clazz);  	103	replace-1
31	Cli_5	buggy:  context:  static  String  stripLeadingHyphens(String  str)  {  if  (str.startsWith( "-- "))  {  return  str.substring(2,  str.length());  }  else  if  (str.startsWith( "- "))  {  return  str.substring(1,  str.length());  	if  (str  ==  null)  {  return  null;  }  	36	add
279	Compress_19	buggy:  if  (rawCentralDirectoryData.length  !=  expectedLength)  {  context:  public  void  reparseCentralDirectoryData(boolean  hasUncompressedSize,  boolean  hasCompressedSize,  boolean  hasRelativeHeaderOffset,  boolean  hasDiskStart)  throws  ZipException  {  if  (rawCentralDirectoryData  !=  null)  {  int  expectedLength  =  (hasUncompressedSize  ?  DWORD  :  0)      if  (rawCentralDirectoryData.length  !=  expectedLength)  {  throw  new  ZipException( "central  directory  zip64  extended "  }  int  offset  =  0;  	if  (rawCentralDirectoryData.length  <  expectedLength)  {  	259	replace-1
392	JacksonDatabind_24	buggy:  TimeZone  tz  =  (df  ==  null)  ?  _timeZone  :  df.getTimeZone();  tz,  _defaultBase64);  context:  }  return  new  BaseSettings(_classIntrospector,  _annotationIntrospector,  _visibilityChecker,  _propertyNamingStrategy,  _typeFactory,  typer,  _dateFormat,  _handlerInstantiator,  _locale,  _timeZone,  _defaultBase64);  }  public  BaseSettings  withDateFormat(DateFormat  df)  {  if  (_dateFormat  ==  df)  {  return  this;  }      TimeZone  tz  =  (df  ==  null)  ?  _timeZone  :  df.getTimeZone();  return  new  BaseSettings(_classIntrospector,  _annotationIntrospector,  _visibilityChecker,  _propertyNamingStrategy,  _typeFactory,  _typeResolverBuilder,  df,  _handlerInstantiator,  _locale,      tz,  _defaultBase64);  }  public  BaseSettings  withHandlerInstantiator(HandlerInstantiator  hi)  {  if  (_handlerInstantiator  ==  hi)  {  return  this;  	_timeZone,  _defaultBase64);  	234	replace-2
42	Cli_17	buggy:  context:  if  (currentOption.hasArg()  &&  (token.length()  !=  (i  +  1)))  {  tokens.add(token.substring(i  +  1));  break;  }  }  else  if  (stopAtNonOption)  {  process(token.substring(i));  }  else  {  tokens.add(token);  break;  }  }  }  }  	break;  	303	add
571	Jsoup_85	buggy:  this.key  =  key.trim();  context:  }  public  Attribute(String  key,  String  val,  Attributes  parent)  {  Validate.notNull(key);      this.key  =  key.trim();  Validate.notEmpty(key);  //  trimming  could  potentially  make  empty,  so  validate  here  this.val  =  val;  this.parent  =  parent;  }  Get  the  attribute  key.  	key  =  key.trim();  this.key  =  key;  	44	replace-1
296	Compress_36	buggy:  context:  public  int  read()  throws  IOException  {  return  getCurrentStream().read();  }  private  InputStream  getCurrentStream()  throws  IOException  {  if  (deferredBlockStreams.isEmpty())  {  throw  new  IllegalStateException( "No  current  7z  entry  (call  getNextEntry()  first). ");  }  while  (deferredBlockStreams.size()  >  1)  {  	if  (archive.files[currentEntryIndex].getSize()  ==  0)  {  return  new  ByteArrayInputStream(new  byte[0]);  }  	902	add
63	Cli_38	buggy:  return  options.hasShortOption(optName);  context:  {  if  (!token.startsWith( "- ")  ||  token.length()  ==  1)  {  return  false;  }  int  pos  =  token.indexOf( "= ");  String  optName  =  pos  ==  -1  ?  token.substring(1)  :  token.substring(1,  pos);      return  options.hasShortOption(optName);  }  	if  (options.hasShortOption(optName))  {  return  true;  }  return  optName.length()  >  0  &&  options.hasShortOption(String.valueOf(optName.charAt(0)));  	310	replace-1
579	Jsoup_93	buggy:  context:  ArrayList<Connection.KeyVal>  data  =  new  ArrayList<>();  for  (Element  el:  elements)  {  if  (!el.tag().isFormSubmittable())  continue;  //  contents  are  form  listable,  superset  of  submitable  if  (el.hasAttr( "disabled "))  continue;  //  skip  disabled  form  inputs  String  name  =  el.attr( "name ");  if  (name.length()  ==  0)  continue;  String  type  =  el.attr( "type ");  if  ( "select ".equals(el.normalName()))  {  Elements  options  =  el.select( "option[selected] ");  boolean  set  =  false;  for  (Element  option:  options)  {  data.add(HttpConnection.KeyVal.create(name,  option.val()));  set  =  true;  }  if  (!set)  {  	if  (type.equalsIgnoreCase( "button "))  continue;  //  browsers  don't  submit  these  	89	add
252	Codec_10	buggy:  txt  =  txt.replaceAll( "^mb ",   "m2 ");  context:  txt  =  txt.replaceAll( "^cough ",   "cou2f ");  txt  =  txt.replaceAll( "^rough ",   "rou2f ");  txt  =  txt.replaceAll( "^tough ",   "tou2f ");  txt  =  txt.replaceAll( "^enough ",   "enou2f ");  //  2.0  only  txt  =  txt.replaceAll( "^trough ",   "trou2f ");  //  2.0  only  -  note  the  spec  says  ^enough  here  again,  c+p  error  I  assume  txt  =  txt.replaceAll( "^gn ",   "2n ");      txt  =  txt.replaceAll( "^mb ",   "m2 ");  txt  =  txt.replaceAll( "cq ",   "2q ");  txt  =  txt.replaceAll( "ci ",   "si ");  txt  =  txt.replaceAll( "ce ",   "se ");  txt  =  txt.replaceAll( "cy ",   "sy ");  txt  =  txt.replaceAll( "tch ",   "2ch ");  txt  =  txt.replaceAll( "c ",   "k ");  	txt  =  txt.replaceAll( "mb$ ",   "m2 ");  	76	replace-1
457	JacksonDatabind_89	buggy:  context:  s.add( "org.apache.commons.collections4.functors.InvokerTransformer ");  s.add( "org.apache.commons.collections4.functors.InstantiateTransformer ");  s.add( "org.codehaus.groovy.runtime.ConvertedClosure ");  s.add( "org.codehaus.groovy.runtime.MethodClosure ");  s.add( "org.springframework.beans.factory.ObjectFactory ");  s.add( "com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl ");  s.add( "org.apache.xalan.xsltc.trax.TemplatesImpl ");  s.add( "com.sun.rowset.JdbcRowSetImpl ");  DEFAULT_NO_DESER_CLASS_NAMES  =  Collections.unmodifiableSet(s);  }  	s.add( "java.util.logging.FileHandler ");  s.add( "java.rmi.server.UnicastRemoteObject ");  s.add( "org.springframework.aop.support.AbstractBeanFactoryPointcutAdvisor ");  s.add( "org.springframework.beans.factory.config.PropertyPathFactoryBean ");  s.add( "com.mchange.v2.c3p0.JndiRefForwardingDataSource ");  s.add( "com.mchange.v2.c3p0.WrapperConnectionPoolDataSource ");  	65	add
532	Jsoup_46	buggy:  accum.append(c);  context:  final  char  c  =  (char)  codePoint;  switch  (c)  {  case  '&':  accum.append( "&amp; ");  break;  case  0xA0:  if  (escapeMode  !=  EscapeMode.xhtml)  accum.append( "&nbsp; ");  else          accum.append(c);  break;  case  '<':  if  (!inAttribute)  accum.append( "&lt; ");  else  accum.append(c);  break;  case  '>':  	accum.append( "&#xa0; ");  	118	replace-1
438	JacksonDatabind_70	buggy:  found  =  key.equals(prop.getName());  context:  boolean  found  =  false;  for  (int  i  =  1,  end  =  _hashArea.length;  i  <  end;  i  +=  2)  {  SettableBeanProperty  prop  =  (SettableBeanProperty)  _hashArea[i];  if  (prop  ==  null)  {  continue;  }  if  (!found)  {      found  =  key.equals(prop.getName());  if  (found)  {  _propsInOrder[_findFromOrdered(prop)]  =  null;  continue;  }  }  props.add(prop);  }  	found  =  key.equals(_hashArea[i-1]);  	440	replace-1
346	JacksonCore_4	buggy:  int  newLen  =  (len  ==  MAX_SEGMENT_LEN)  ?  (MAX_SEGMENT_LEN+1)  :  Math.min(MAX_SEGMENT_LEN,  len  +  (len  >>  1));  context:  public  char[]  expandCurrentSegment()  {  final  char[]  curr  =  _currentSegment;  final  int  len  =  curr.length;      int  newLen  =  (len  ==  MAX_SEGMENT_LEN)  ?  (MAX_SEGMENT_LEN+1)  :  Math.min(MAX_SEGMENT_LEN,  len  +  (len  >>  1));  return  (_currentSegment  =  Arrays.copyOf(curr,  newLen));  }  	int  newLen  =  len  +  (len  >>  1);  if  (newLen  >  MAX_SEGMENT_LEN)  {  newLen  =  len  +  (len  >>  2);  }  	585	replace-1
261	Compress_1	buggy:  context:  public  void  close()  throws  IOException  {  if  (!this.closed)  {  super.close();  this.closed  =  true;  }  }  private  void  pad(final  long  count,  final  int  border)  throws  IOException  {  long  skip  =  count  %  border;  if  (skip  >  0)  {  byte  tmp[]  =  new  byte[(int)  (border  -  skip)];  	this.finish();  	346	add
395	JacksonDatabind_27	buggy:  if  (ext.handlePropertyValue(p,  ctxt,  propName,  buffer))  {  context:  JsonToken  t  =  p.getCurrentToken();  for  (;  t  ==  JsonToken.FIELD_NAME;  t  =  p.nextToken())  {  String  propName  =  p.getCurrentName();  p.nextToken();  //  to  point  to  value  SettableBeanProperty  creatorProp  =  creator.findCreatorProperty(propName);  if  (creatorProp  !=  null)  {      if  (ext.handlePropertyValue(p,  ctxt,  propName,  buffer))  {  ;  }  else  {  if  (buffer.assignParameter(creatorProp,  _deserializeWithErrorWrapping(p,  ctxt,  creatorProp)))  {  t  =  p.nextToken();  //  to  move  to  following  FIELD_NAME/END_OBJECT  Object  bean;  try  {  bean  =  creator.build(ctxt,  buffer);  	if  (ext.handlePropertyValue(p,  ctxt,  propName,  null))  {  	794	replace-1
575	Jsoup_89	buggy:  String  oldVal  =  parent.get(this.key);  context:  public  String  getValue()  {  return  Attributes.checkNotNull(val);  }  Set  the  attribute  value.  public  String  setValue(String  val)  {      String  oldVal  =  parent.get(this.key);  if  (parent  !=  null)  {  int  i  =  parent.indexOfKey(this.key);  if  (i  !=  Attributes.NotFound)  parent.vals[i]  =  val;  }  this.val  =  val;  return  Attributes.checkNotNull(oldVal);  	String  oldVal  =  this.val;  oldVal  =  parent.get(this.key);  //  trust  the  container  more  	88	replace-1
469	JacksonDatabind_101	buggy:  p.nextToken();  context:  try  {  bean  =  creator.build(ctxt,  buffer);  }  catch  (Exception  e)  {  bean  =  wrapInstantiationProblem(e,  ctxt);  }  p.setCurrentValue(bean);  while  (t  ==  JsonToken.FIELD_NAME)  {          p.nextToken();  tokens.copyCurrentStructure(p);  t  =  p.nextToken();  }  	if  (t  !=  JsonToken.END_OBJECT)  {  ctxt.reportWrongTokenException(this,  JsonToken.END_OBJECT,   "Attempted  to  unwrap  '%s'  value ",  handledType().getName());  }  	771	replace-1
59	Cli_34	buggy:  type  =  null;  context:  }  private  static  void  reset()  {  description  =  null;  argName  =  null;  longopt  =  null;      type  =  null;  required  =  false;  numberOfArgs  =  Option.UNINITIALIZED;  optionalArg  =  false;  valuesep  =  (char)  0;  }  	type  =  String.class;  	84	replace-1
517	Jsoup_31	buggy:  context:  tag.setSelfClosing();  }  else  {  stack.add(el);  }  return  el;  }  void  insert(Token.Comment  commentToken)  {  Comment  comment  =  new  Comment(commentToken.getData(),  baseUri);  Node  insert  =  comment;  insertNode(insert);  }  	if  (commentToken.bogus)  {  //  xml  declarations  are  emitted  as  bogus  comments  (which  is  right  for  html,  but  not  xml)  String  data  =  comment.getData();  if  (data.length()  >  1  &&  (data.startsWith( "! ")  ||  data.startsWith( "? ")))  {  String  declaration  =  data.substring(1);  insert  =  new  XmlDeclaration(declaration,  comment.baseUri(),  data.startsWith( "! "));  }  }  	67	add
368	JacksonCore_26	buggy:  context:  if  (_endOfInput)  {  _reportError( "Already  closed,  can  not  feed  more  input ");  }  _currInputProcessed  +=  _origBufferLen;  _currInputRowStart  =  start  -  (_inputEnd  -  _currInputRowStart);  _inputBuffer  =  buf;  _inputPtr  =  start;  _inputEnd  =  end;  _origBufferLen  =  end  -  start;  }  public  void  endOfInput()  {  _endOfInput  =  true;  	_currBufferStart  =  start;  	108	add
379	JacksonDatabind_11	buggy:  return  _unknownType();  JavaType  actualType  =  context.findType(name);  context:  JavaType  compType  =  _constructType(type.getGenericComponentType(),  context);  return  ArrayType.construct(compType,  null,  null);  }  protected  JavaType  _fromVariable(TypeVariable<?>  type,  TypeBindings  context)  {  final  String  name  =  type.getName();  if  (context  ==  null)  {      return  _unknownType();  }  else  {      JavaType  actualType  =  context.findType(name);  	context  =  new  TypeBindings(this,  (Class<?>)  null);  JavaType  actualType  =  context.findType(name,  false);  	895	replace-2
513	Jsoup_27	buggy:  return  charset;  context:  static  String  getCharsetFromContentType(String  contentType)  {  if  (contentType  ==  null)  return  null;  Matcher  m  =  charsetPattern.matcher(contentType);  if  (m.find())  {  String  charset  =  m.group(1).trim();  charset  =  charset.toUpperCase(Locale.ENGLISH);      return  charset;  }  return  null;  }  }  	if  (Charset.isSupported(charset))  return  charset;  if  (Charset.isSupported(charset))  return  charset;  	132	replace-1
337	Gson_13	buggy:  if  (last  ==  NUMBER_CHAR_DIGIT  &&  fitsInLong  &&  (value  !=  Long.MIN_VALUE  ||  negative))  {  context:  value  =  newValue;  }  else  if  (last  ==  NUMBER_CHAR_DECIMAL)  {  last  =  NUMBER_CHAR_FRACTION_DIGIT;  }  else  if  (last  ==  NUMBER_CHAR_EXP_E  ||  last  ==  NUMBER_CHAR_EXP_SIGN)  {  last  =  NUMBER_CHAR_EXP_DIGIT;  }  }  }  if  (last  ==  NUMBER_CHAR_DIGIT  &&  fitsInLong  &&  (value  !=  Long.MIN_VALUE  ||  negative))  {  peekedLong  =  negative  ?  value  :  -value;  pos  +=  i;  return  peeked  =  PEEKED_LONG;  }  else  if  (last  ==  NUMBER_CHAR_DIGIT  ||  last  ==  NUMBER_CHAR_FRACTION_DIGIT  ||  last  ==  NUMBER_CHAR_EXP_DIGIT)  {  peekedNumberLength  =  i;  return  peeked  =  PEEKED_NUMBER;  }  else  {  	if  (last  ==  NUMBER_CHAR_DIGIT  &&  fitsInLong  &&  (value  !=  Long.MIN_VALUE  ||  negative)  &&  (value!=0  ||  false==negative))  {  	731	replace-1
414	JacksonDatabind_46	buggy:   context:  public  StringBuilder  getErasedSignature(StringBuilder  sb)  {  return  _classSignature(_class,  sb,  true);  }  public  StringBuilder  getGenericSignature(StringBuilder  sb)  {  _classSignature(_class,  sb,  false);  sb.append('<');  sb  =  _referencedType.getGenericSignature(sb);      sb.append(';');  return  sb;  }  	sb.append( '>');  	156	add
556	Jsoup_70	buggy:  else  return  el.parent()  !=  null  &&  el.parent().tag.preserveWhitespace();  context:  private  static  void  appendWhitespaceIfBr(Element  element,  StringBuilder  accum)  {  if  (element.tag.getName().equals( "br ")  &&  !TextNode.lastCharIsWhitespace(accum))  accum.append( "   ");  }  static  boolean  preserveWhitespace(Node  node)  {  if  (node  !=  null  &&  node  instanceof  Element)  {  Element  el  =  (Element)  node;  if  (el.tag.preserveWhitespace())  return  true;      else          return  el.parent()  !=  null  &&  el.parent().tag.preserveWhitespace();  }  	int  i  =  0;  do  {  el  =  el.parent();  i++;  }  while  (i  <  6  &&  el  !=  null);  	1091	replace-2
249	Codec_7	buggy:  return  StringUtils.newStringUtf8(encodeBase64(binaryData,  true));  context:  public  static  String  encodeBase64String(byte[]  binaryData)  {      return  StringUtils.newStringUtf8(encodeBase64(binaryData,  true));  }  	return  StringUtils.newStringUtf8(encodeBase64(binaryData,  false));  	670	replace-1
309	Csv_2	buggy:  context:  public  String  get(final  String  name)  {  if  (mapping  ==  null)  {  throw  new  IllegalStateException(   "No  header  mapping  was  specified,  the  record  values  can't  be  accessed  by  name ");  }  final  Integer  index  =  mapping.get(name);  return  index  !=  null  ?  values[index.intValue()]  :  null;  }  	try  {  }  catch  (ArrayIndexOutOfBoundsException  e)  {  throw  new  IllegalArgumentException(  String.format(   "Index  for  header  '%s'  is  %d  but  CSVRecord  only  has  %d  values! ",  name,  index.intValue(),  values.length));  }  	85	add
484	JacksonXml_4	buggy:  _initWithRootName((ToXmlGenerator)  jgen,  ROOT_NAME_FOR_NULL);  context:  if  (asArray)  {  gen.writeEndObject();  }  }  protected  void  _serializeXmlNull(JsonGenerator  jgen)  throws  IOException  {  if  (jgen  instanceof  ToXmlGenerator)  {      _initWithRootName((ToXmlGenerator)  jgen,  ROOT_NAME_FOR_NULL);  }  super.serializeValue(jgen,  null);  }  	QName  rootName  =  _rootNameFromConfig();  if  (rootName  ==  null)  {  rootName  =  ROOT_NAME_FOR_NULL;  }  _initWithRootName((ToXmlGenerator)  jgen,  rootName);  	204	replace-1
461	JacksonDatabind_93	buggy:  if  (full.startsWith(PREFIX_STRING))  {  for  (Class<?>  cls  =  raw;  cls  !=  Object.class;  cls  =  cls.getSuperclass())  {  context:  main_check:  do  {  if  (_cfgIllegalClassNames.contains(full))  {  break;  }      if  (full.startsWith(PREFIX_STRING))  {      for  (Class<?>  cls  =  raw;  cls  !=  Object.class;  cls  =  cls.getSuperclass())  {  String  name  =  cls.getSimpleName();  if  ( "AbstractPointcutAdvisor ".equals(name)  ||   "AbstractApplicationContext ".equals(name))  {  break  main_check;  	if  (!raw.isInterface()  &&  full.startsWith(PREFIX_STRING))  {  for  (Class<?>  cls  =  raw;  (cls  !=  null)  &&  (cls  !=  Object.class);  cls  =  cls.getSuperclass())  {  	83	replace-2
350	JacksonCore_8	buggy:  if  (!_hasSegments)  return  _currentSegment;  context:  public  char[]  getTextBuffer()  {  if  (_inputStart  >=  0)  return  _inputBuffer;  if  (_resultArray  !=  null)  return  _resultArray;  if  (_resultString  !=  null)  {  return  (_resultArray  =  _resultString.toCharArray());  }      if  (!_hasSegments)  return  _currentSegment;  return  contentsAsArray();  }  	if  (!_hasSegments  &&  _currentSegment  !=  null)    return  _currentSegment;  	307	replace-1
301	Compress_41	buggy:  return  null;  context:  readFully(LFH_BUF);  }  }  catch  (final  EOFException  e)  {  return  null;  }  final  ZipLong  sig  =  new  ZipLong(LFH_BUF);  if  (sig.equals(ZipLong.CFH_SIG)  ||  sig.equals(ZipLong.AED_SIG))  {  hitCentralDirectory  =  true;  skipRemainderOfArchive();  }  if  (!sig.equals(ZipLong.LFH_SIG))  {      return  null;  }  int  off  =  WORD;  current  =  new  CurrentEntry();  	return  null;  throw  new  ZipException(String.format( "Unexpected  record  signature:  0X%X ",  sig.getValue()));  	247	replace-1
276	Compress_16	buggy:  tais.getNextEntry();  context:  signatureLength  =  in.read(tarheader);  in.reset();  if  (TarArchiveInputStream.matches(tarheader,  signatureLength))  {  return  new  TarArchiveInputStream(in);  }  if  (signatureLength  >=  512)  {  try  {  TarArchiveInputStream  tais  =  new  TarArchiveInputStream(new  ByteArrayInputStream(tarheader));          tais.getNextEntry();  return  new  TarArchiveInputStream(in);  }  catch  (Exception  e)  {  //  NOPMD  }  	if  (tais.getNextTarEntry().isCheckSumOK())  {  }  	244	replace-1
320	Csv_13	buggy:  .withQuote(null).withRecordSeparator(LF);  context:  public  static  final  CSVFormat  MYSQL  =  DEFAULT.withDelimiter(TAB).withEscape(BACKSLASH).withIgnoreEmptyLines(false)      .withQuote(null).withRecordSeparator(LF);  	.withQuote(null).withRecordSeparator(LF).withNullString( "\\N ");  	319	replace-1
319	Csv_12	buggy:  public  static  final  CSVFormat  EXCEL  =  DEFAULT.withIgnoreEmptyLines(false);  context:  public  static  final  CSVFormat  EXCEL  =  DEFAULT.withIgnoreEmptyLines(false);  	public  static  final  CSVFormat  EXCEL  =  DEFAULT.withIgnoreEmptyLines(false).withAllowMissingColumnNames(true);  	219	replace-1
44	Cli_19	buggy:  tokens.add(token);  tokens.add(token);  context:  private  void  processOptionToken(String  token,  boolean  stopAtNonOption)  {  if  (options.hasOption(token))  {  currentOption  =  options.getOption(token);      tokens.add(token);  }  else  if  (stopAtNonOption)  {  eatTheRest  =  true;      tokens.add(token);  }  }  	  tokens.add(token);  	232	replace-2
277	Compress_17	buggy:  if  (trailer  ==  0  ||  trailer  ==  '  '){  context:  byte  trailer;  trailer  =  buffer[end-1];  if  (trailer  ==  0  ||  trailer  ==  '  '){  end--;  }  else  {  throw  new  IllegalArgumentException(  exceptionMessage(buffer,  offset,  length,  end-1,  trailer));  }  trailer  =  buffer[end  -  1];      if  (trailer  ==  0  ||  trailer  ==  '  '){  end--;  }  for  (  ;start  <  end;  start++)  {  final  byte  currentByte  =  buffer[start];  if  (currentByte  <  '0'  ||  currentByte  >  '7'){  	while  (start  <  end  -  1  &&  (trailer  ==  0  ||  trailer  ==  '  '))  {  trailer  =  buffer[end  -  1];  	135	replace-1
460	JacksonDatabind_92	buggy:  context:  s.add( "org.apache.commons.collections4.functors.InvokerTransformer ");  s.add( "org.apache.commons.collections4.functors.InstantiateTransformer ");  s.add( "org.codehaus.groovy.runtime.ConvertedClosure ");  s.add( "org.codehaus.groovy.runtime.MethodClosure ");  s.add( "org.springframework.beans.factory.ObjectFactory ");  s.add( "com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl ");  s.add( "org.apache.xalan.xsltc.trax.TemplatesImpl ");  s.add( "com.sun.rowset.JdbcRowSetImpl ");  DEFAULT_NO_DESER_CLASS_NAMES  =  Collections.unmodifiableSet(s);  }  	s.add( "java.util.logging.FileHandler ");  s.add( "java.rmi.server.UnicastRemoteObject ");  s.add( "org.springframework.aop.support.AbstractBeanFactoryPointcutAdvisor ");  s.add( "org.springframework.beans.factory.config.PropertyPathFactoryBean ");  s.add( "com.mchange.v2.c3p0.JndiRefForwardingDataSource ");  s.add( "com.mchange.v2.c3p0.WrapperConnectionPoolDataSource ");  	64	add
485	JacksonXml_5	buggy:  _rootNameLookup  =  src._rootNameLookup;  context:  _rootNameLookup  =  src._rootNameLookup;  }  protected  XmlSerializerProvider(XmlSerializerProvider  src)  {  super(src);      _rootNameLookup  =  src._rootNameLookup;  }  	_rootNameLookup  =  new  XmlRootNameLookup();  	59	replace-1
585	JxPath_6	buggy:  if  (l  instanceof  InitialContext  ||  l  instanceof  SelfContext)  {  if  (r  instanceof  InitialContext  ||  r  instanceof  SelfContext)  {  context:  Expression  left,  Expression  right)  {  Object  l  =  left.compute(context);  Object  r  =  right.compute(context);      if  (l  instanceof  InitialContext  ||  l  instanceof  SelfContext)  {  l  =  ((EvalContext)  l).getSingleNodePointer();  }      if  (r  instanceof  InitialContext  ||  r  instanceof  SelfContext)  {  	if  (l  instanceof  InitialContext)  {  ((EvalContext)  l).reset();  }    if  (l  instanceof  SelfContext)  {  if  (r  instanceof  InitialContext)  {  ((EvalContext)  r).reset();  }    if  (r  instanceof  SelfContext)  {  	57	replace-2
452	JacksonDatabind_84	buggy:  context:  public  void  setReference(JavaType  ref)  {  if  (_referencedType  !=  null)  {  throw  new  IllegalStateException( "Trying  to  re-set  self  reference;  old  value  =   "+_referencedType+ ",  new  =   "+ref);  }  _referencedType  =  ref;  }  public  JavaType  getSelfReferencedType()  {  return  _referencedType;  }  	@Override  public  JavaType  getSuperClass()  {  if  (_referencedType  !=  null)  {  return  _referencedType.getSuperClass();  }  return  super.getSuperClass();  }  	29	add
310	Csv_3	buggy:  context:  case  CR:  case  LF:  case  FF:  //  TODO  is  this  correct?  case  TAB:  //  TODO  is  this  correct?  Do  tabs  need  to  be  escaped?  case  BACKSPACE:  //  TODO  is  this  correct?  return  c;  case  END_OF_STREAM:  throw  new  IOException( "EOF  whilst  processing  escape  sequence ");  default:  return  c;  }  }  void  trimTrailingSpaces(final  StringBuilder  buffer)  {  int  length  =  buffer.length();  	if  (isDelimiter(c)  ||  isEscape(c)  ||  isQuoteChar(c)  ||  isCommentStart(c))  {  }  return  END_OF_STREAM;  	111	add
415	JacksonDatabind_47	buggy:  context:  Class<?>  serClass  =  findSerializationType(a);  if  (serClass  !=  null)  {  if  (type.hasRawClass(serClass))  {  type  =  type.withStaticTyping();  }  else  {  try  {  type  =  tf.constructGeneralizedType(type,  serClass);  	Class<?>  currRaw  =  type.getRawClass();  if  (serClass.isAssignableFrom(currRaw))  {  //  common  case  }  else  if  (currRaw.isAssignableFrom(serClass))  {  //  specialization,  ok  as  well  type  =  tf.constructSpecializedType(type,  serClass);  }  else  {  throw  new  JsonMappingException(null,  String.format( "Can  not  refine  serialization  type  %s  into  %s;  types  not  related ",  type,  serClass.getName()));  }  	816	add
557	Jsoup_71	buggy:  context:  else  if  (tq.matchChomp( ":last-of-type "))  evals.add(new  Evaluator.IsLastOfType());  else  if  (tq.matchChomp( ":only-child "))  evals.add(new  Evaluator.IsOnlyChild());  else  if  (tq.matchChomp( ":only-of-type "))  evals.add(new  Evaluator.IsOnlyOfType());  else  if  (tq.matchChomp( ":empty "))  evals.add(new  Evaluator.IsEmpty());  else  if  (tq.matchChomp( ":root "))  evals.add(new  Evaluator.IsRoot());  else  //  unhandled  throw  new  Selector.SelectorParseException( "Could  not  parse  query  '%s':  unexpected  token  at  '%s' ",  query,  tq.remainder());  }  private  void  byId()  {  String  id  =  tq.consumeCssIdentifier();  Validate.notEmpty(id);  	else  if  (tq.matchChomp( ":matchText "))  evals.add(new  Evaluator.MatchText());  	203	add
336	Gson_12	buggy:  context:  stack  =  new  Object[]  {  SENTINEL_CLOSED  };  stackSize  =  1;  }  if  (peek()  ==  JsonToken.NAME)  {  nextName();  pathNames[stackSize  -  2]  =   "null ";  }  else  {  popStack();  pathNames[stackSize  -  1]  =   "null ";  }  pathIndices[stackSize  -  1]++;  }  	if  (stackSize  >  0)  {  }  if  (stackSize  >  0)  {  }  	262	add
326	Gson_2	buggy:  return  (TypeAdapter<T2>)  typeAdapter;  context:  public  static  <T1>  TypeAdapterFactory  newTypeHierarchyFactory(  final  Class<T1>  clazz,  final  TypeAdapter<T1>  typeAdapter)  {  return  new  TypeAdapterFactory()  {  public  <T2>  TypeAdapter<T2>  create(Gson  gson,  TypeToken<T2>  typeToken)  {  final  Class<?  super  T2>  requestedType  =  typeToken.getRawType();  if  (!clazz.isAssignableFrom(requestedType))  {  return  null;  }      return  (TypeAdapter<T2>)  typeAdapter;  	return  (TypeAdapter<T2>)  new  TypeAdapter<T1>()  {  @Override  public  void  write(JsonWriter  out,  T1  value)  throws  IOException  {  typeAdapter.write(out,  value);  }  @Override  public  T1  read(JsonReader  in)  throws  IOException  {  T1  result  =  typeAdapter.read(in);  if  (result  !=  null  &&  !requestedType.isInstance(result))  {  throw  new  JsonSyntaxException( "Expected  a   "  +  requestedType.getName()  +   "  but  was   "  +  result.getClass().getName());  }  return  result;  }  };  	833	replace-1
512	Jsoup_26	buggy:  context:  Creates  a  new,  clean  document,  from  the  original  dirty  document,  containing  only  elements  allowed  by  the  whitelist.  The  original  document  is  not  modified.  Only  elements  from  the  dirt  document's  <code>body</code>  are  used.  public  Document  clean(Document  dirtyDocument)  {  Validate.notNull(dirtyDocument);  Document  clean  =  Document.createShell(dirtyDocument.baseUri());  copySafeNodes(dirtyDocument.body(),  clean.body());  return  clean;  }  Determines  if  the  input  document  is  valid,  against  the  whitelist.  It  is  considered  valid  if  all  the  tags  and  attributes  in  the  input  HTML  are  allowed  by  the  whitelist.  <p/>  	if  (dirtyDocument.body()  !=  null)  //  frameset  documents  won't  have  a  body.  the  clean  doc  will  have  empty  body.  	43	add
60	Cli_35	buggy:  context:  public  List<String>  getMatchingOptions(String  opt)  {  opt  =  Util.stripLeadingHyphens(opt);  List<String>  matchingOpts  =  new  ArrayList<String>();  for  (String  longOpt  :  longOpts.keySet())  {  if  (longOpt.startsWith(opt))  {  matchingOpts.add(longOpt);  }  	if(longOpts.keySet().contains(opt))  {  return  Collections.singletonList(opt);  }  	240	add
468	JacksonDatabind_100	buggy:  byte[]  data  =  n.binaryValue();  if  (data  !=  null)  {  return  data;  }  if  (n.isPojo())  {  Object  ob  =  ((POJONode)  n).getPojo();  if  (ob  instanceof  byte[])  {  return  (byte[])  ob;  }  context:  public  byte[]  getBinaryValue(Base64Variant  b64variant)  throws  IOException,  JsonParseException  {  JsonNode  n  =  currentNode();  if  (n  !=  null)  {      byte[]  data  =  n.binaryValue();      if  (data  !=  null)  {      return  data;      }      if  (n.isPojo())  {      Object  ob  =  ((POJONode)  n).getPojo();      if  (ob  instanceof  byte[])  {          return  (byte[])  ob;      }  	if  (n  instanceof  TextNode)  {  return  ((TextNode)  n).getBinaryValue(b64variant);  return  n.binaryValue();  	363	replace-9
574	Jsoup_88	buggy:  return  val;  context:  parent.keys[i]  =  key;  }  this.key  =  key;  }  Get  the  attribute  value.  public  String  getValue()  {      return  val;  }  Set  the  attribute  value.  public  String  setValue(String  val)  {  String  oldVal  =  parent.get(this.key);  	return  Attributes.checkNotNull(val);  	80	replace-1
591	JxPath_12	buggy:  return  equalStrings(namespaceURI,  nodeNS);  context:  String  namespaceURI  =  nodeNameTest.getNamespaceURI();  boolean  wildcard  =  nodeNameTest.isWildcard();  String  testPrefix  =  testName.getPrefix();  if  (wildcard  &&  testPrefix  ==  null)  {  return  true;  }  if  (wildcard  ||  testName.getName()  .equals(DOMNodePointer.getLocalName(node)))  {  String  nodeNS  =  DOMNodePointer.getNamespaceURI(node);      return  equalStrings(namespaceURI,  nodeNS);  }  return  false;  }  if  (test  instanceof  NodeTypeTest)  {  int  nodeType  =  node.getNodeType();  switch  (((NodeTypeTest)  test).getNodeType())  {  case  Compiler.NODE_TYPE_NODE  :  	return  equalStrings(namespaceURI,  nodeNS)  ||  nodeNS  ==  null  &&  equalStrings(testPrefix,  getPrefix(node));  	108	replace-1
419	JacksonDatabind_51	buggy:  context:  &&  _baseType.getClass()  ==  type.getClass())  {  type  =  ctxt.getTypeFactory().constructSpecializedType(_baseType,  type.getRawClass());  }  deser  =  ctxt.findContextualValueDeserializer(type,  _property);  }  _deserializers.put(typeId,  deser);  }  return  deser;  }  	if  (!type.hasGenericTypes())  {  }  	184	add
496	Jsoup_10	buggy:  context:  URL  base;  try  {  try  {  base  =  new  URL(baseUri);  }  catch  (MalformedURLException  e)  {  URL  abs  =  new  URL(relUrl);  return  abs.toExternalForm();  }  URL  abs  =  new  URL(base,  relUrl);  return  abs.toExternalForm();  }  catch  (MalformedURLException  e)  {  return   " ";  }  }  }  	if  (relUrl.startsWith( "? "))  relUrl  =  base.getPath()  +  relUrl;  	173	add
394	JacksonDatabind_26	buggy:  implements  BeanProperty  context:  public  class  BeanPropertyWriter  extends  PropertyWriter  implements  BeanProperty  {  	implements  BeanProperty,  java.io.Serializable  //  since  2.6.2  private  static  final  long  serialVersionUID  =  4603296144163950020L;  	39	replace-1
533	Jsoup_47	buggy:  if  (!inAttribute)  context:  accum.append( "&amp; ");  break;  case  0xA0:  if  (escapeMode  !=  EscapeMode.xhtml)  accum.append( "&nbsp; ");  else  accum.append( "&#xa0; ");  break;  case  '<':          if  (!inAttribute)  accum.append( "&lt; ");  else  accum.append(c);  break;  case  '>':  if  (!inAttribute)  accum.append( "&gt; ");  else  	if  (!inAttribute  ||  escapeMode  ==  EscapeMode.xhtml)  	122	replace-1
439	JacksonDatabind_71	buggy:  if  (raw  ==  String.class  ||  raw  ==  Object.class)  {  context:  _kind  =  kind;  _keyClass  =  cls;  _deser  =  deser;  }  public  static  StdKeyDeserializer  forType(Class<?>  raw)  {  int  kind;      if  (raw  ==  String.class  ||  raw  ==  Object.class)  {  return  StringKD.forType(raw);  }  else  if  (raw  ==  UUID.class)  {  kind  =  TYPE_UUID;  }  else  if  (raw  ==  Integer.class)  {  kind  =  TYPE_INT;  }  else  if  (raw  ==  Long.class)  {  kind  =  TYPE_LONG;  }  else  if  (raw  ==  Date.class)  {  	if  (raw  ==  String.class  ||  raw  ==  Object.class  ||  raw  ==  CharSequence.class)  {  	75	replace-1
347	JacksonCore_5	buggy:  char  c  =  str.charAt(i++);  context:  private  final  static  int  _parseIndex(String  str)  {  final  int  len  =  str.length();  if  (len  ==  0  ||  len  >  10)  {  return  -1;  }  for  (int  i  =  0;  i  <  len;  ++i)  {      char  c  =  str.charAt(i++);  if  (c  >  '9'  ||  c  <  '0')  {  return  -1;  }  }  if  (len  ==  10)  {  long  l  =  NumberInput.parseLong(str);  if  (l  >  Integer.MAX_VALUE)  {  return  -1;  	char  c  =  str.charAt(i);  	193	replace-1
537	Jsoup_51	buggy:  return  (c  >=  'A'  &&  c  <=  'Z')  ||  (c  >=  'a'  &&  c  <=  'z');  context:  }  boolean  matchesAnySorted(char[]  seq)  {  return  !isEmpty()  &&  Arrays.binarySearch(seq,  input[pos])  >=  0;  }  boolean  matchesLetter()  {  if  (isEmpty())  return  false;  char  c  =  input[pos];      return  (c  >=  'A'  &&  c  <=  'Z')  ||  (c  >=  'a'  &&  c  <=  'z');  }  boolean  matchesDigit()  {  if  (isEmpty())  return  false;  char  c  =  input[pos];  return  (c  >=  '0'  &&  c  <=  '9');  }  	return  (c  >=  'A'  &&  c  <=  'Z')  ||  (c  >=  'a'  &&  c  <=  'z')  ||  Character.isLetter(c);  	300	replace-1
456	JacksonDatabind_88	buggy:  context:  TypeFactory  tf  =  ctxt.getTypeFactory();  if  (id.indexOf('<')  >  0)  {  JavaType  t  =  tf.constructFromCanonical(id);  return  t;  }  Class<?>  cls;  try  {  cls  =  tf.findClass(id);  	if  (!t.isTypeOrSubTypeOf(_baseType.getRawClass()))  {  throw  new  IllegalArgumentException(String.format(   "Class  %s  not  subtype  of  %s ",  t.getRawClass().getName(),  _baseType));  }  	58	add
435	JacksonDatabind_67	buggy:  return  _createEnumKeyDeserializer(ctxt,  type);  deser  =  StdKeyDeserializers.findStringBasedKeyDeserializer(config,  type);  context:  for  (KeyDeserializers  d  :  _factoryConfig.keyDeserializers())  {  deser  =  d.findKeyDeserializer(type,  config,  beanDesc);  if  (deser  !=  null)  {  break;  }  }  }  if  (deser  ==  null)  {  if  (type.isEnumType())  {      return  _createEnumKeyDeserializer(ctxt,  type);  }      deser  =  StdKeyDeserializers.findStringBasedKeyDeserializer(config,  type);  }  if  (deser  !=  null)  {  if  (_factoryConfig.hasDeserializerModifiers())  {  	deser  =  _createEnumKeyDeserializer(ctxt,  type);  }  else  {  deser  =  StdKeyDeserializers.findStringBasedKeyDeserializer(config,  type);  	1403	replace-2
353	JacksonCore_11	buggy:  context:  }  private  void  _verifySharing()  {  if  (_hashShared)  {  _hashArea  =  Arrays.copyOf(_hashArea,  _hashArea.length);  _names  =  Arrays.copyOf(_names,  _names.length);  _hashShared  =  false;  }  if  (_needRehash)  {  rehash();  }  }  	_verifyNeedForRehash();  	882	add
578	Jsoup_92	buggy:  context:  public  boolean  preserveTagCase()  {  return  preserveTagCase;  }  public  ParseSettings(boolean  tag,  boolean  attribute)  {  	public  boolean  preserveAttributeCase()  {  return  preserveAttributeCase;  }  	38	add
492	Jsoup_6	buggy:  m.appendReplacement(accum,  c);  m.appendReplacement(accum,  m.group(0));  context:  }  catch  (NumberFormatException  e)  {  }  //  skip  }  else  {  String  name  =  m.group(1);  if  (full.containsKey(name))  charval  =  full.get(name);  }  if  (charval  !=  -1  ||  charval  >  0xFFFF)  {  //  out  of  range  String  c  =  Character.toString((char)  charval);      m.appendReplacement(accum,  c);  }  else  {      m.appendReplacement(accum,  m.group(0));  }  }  m.appendTail(accum);  return  accum.toString();  }  	m.appendReplacement(accum,  Matcher.quoteReplacement(c));  m.appendReplacement(accum,  Matcher.quoteReplacement(m.group(0)));  //  replace  with  original  string  	70	replace-2
281	Compress_21	buggy:  --shift;  if  (shift  ==  0)  {  if  (length  >  0  &&  shift  >  0)  {  context:  header.write((int)  (0xff  &  value));  value  >>>=  8;  }  }  private  void  writeBits(final  DataOutput  header,  final  BitSet  bits,  final  int  length)  throws  IOException  {  int  cache  =  0;  int  shift  =  7;  for  (int  i  =  0;  i  <  length;  i++)  {  cache  |=  ((bits.get(i)  ?  1  :  0)  <<  shift);      --shift;      if  (shift  ==  0)  {  header.write(cache);  shift  =  7;  cache  =  0;  }  }      if  (length  >  0  &&  shift  >  0)  {  	if  (--shift  <  0)  {  if  (shift  !=  7)  {  	639	replace-3
370	JacksonDatabind_2	buggy:  context:  public  void  writeObject(Object  value)  throws  IOException  {  _append(JsonToken.VALUE_EMBEDDED_OBJECT,  value);  	if  (value  ==  null)  {  writeNull();  return;  }  Class<?>  raw  =  value.getClass();  if  (raw  ==  byte[].class)  {  return;  }  else  if  (_objectCodec  ==  null)  {  _append(JsonToken.VALUE_EMBEDDED_OBJECT,  value);  }  else  {  _objectCodec.writeValue(this,  value);  }  if  (node  ==  null)  {  writeNull();  return;  }  if  (_objectCodec  ==  null)  {  }  else  {  _objectCodec.writeTree(this,  node);  }  	783	add
297	Compress_37	buggy:  if  (ch  ==  '  '){  context:  Map<String,  String>  parsePaxHeaders(final  InputStream  i)  throws  IOException  {  final  Map<String,  String>  headers  =  new  HashMap<String,  String>(globalPaxHeaders);  while(true){  //  get  length  int  ch;  int  len  =  0;  int  read  =  0;  while((ch  =  i.read())  !=  -1)  {  read++;      if  (ch  ==  '  '){  final  ByteArrayOutputStream  coll  =  new  ByteArrayOutputStream();  while((ch  =  i.read())  !=  -1)  {  read++;  if  (ch  ==  '='){  //  end  of  keyword  final  String  keyword  =  coll.toString(CharsetNames.UTF_8);  	if  (ch  ==  '\n')  {  //  blank  line  in  header  break;  }  else  if  (ch  ==  '  '){  //  End  of  length  string  	462	replace-1
570	Jsoup_84	buggy:  Element  el  =  context:  public  void  head(org.jsoup.nodes.Node  source,  int  depth)  {  namespacesStack.push(new  HashMap<>(namespacesStack.peek()));  //  inherit  from  above  on  the  stack  if  (source  instanceof  org.jsoup.nodes.Element)  {  org.jsoup.nodes.Element  sourceEl  =  (org.jsoup.nodes.Element)  source;  String  prefix  =  updateNamespaces(sourceEl);  String  namespace  =  namespacesStack.peek().get(prefix);  String  tagName  =  sourceEl.tagName();      Element  el  =  doc.createElementNS(namespace,  tagName);  copyAttributes(sourceEl,  el);  if  (dest  ==  null)  {  //  sets  up  the  root  doc.appendChild(el);  }  else  {  dest.appendChild(el);  }  	Element  el  =  namespace  ==  null  &&  tagName.contains( ": ")  ?  doc.createElementNS( " ",  tagName)  :  //  doesn't  have  a  real  namespace  defined  	91	replace-1
546	Jsoup_60	buggy:  context:  }  else  if  (c.equals(close))  depth--;  }  if  (depth  >  0  &&  last  !=  0)  end  =  pos;  //  don't  include  the  outer  match  pair  in  the  return  last  =  c;  }  while  (depth  >  0);  final  String  out  =  (end  >=  0)  ?  queue.substring(start,  end)  :   " ";  return  out;  }  	if  (depth  >  0)  {//  ran  out  of  queue  before  seeing  enough  )  Validate.fail( "Did  not  find  balanced  maker  at   "  +  out);  }  	289	add
475	JacksonDatabind_107	buggy:  return  null;  context:  JavaType  type  =  _idResolver.typeFromId(ctxt,  typeId);  if  (type  ==  null)  {  deser  =  _findDefaultImplDeserializer(ctxt);  if  (deser  ==  null)  {  JavaType  actual  =  _handleUnknownTypeId(ctxt,  typeId);  if  (actual  ==  null)  {  //  what  should  this  be  taken  to  mean?          return  null;  }  deser  =  ctxt.findContextualValueDeserializer(actual,  _property);  }  }  else  {  	return  NullifyingDeserializer.instance;  	165	replace-1
377	JacksonDatabind_9	buggy:  if  (value  instanceof  Date)  {  context:  public  class  StdKeySerializer  extends  StdSerializer<Object>  {  public  StdKeySerializer()  {  super(Object.class);  }  public  void  serialize(Object  value,  JsonGenerator  jgen,  SerializerProvider  provider)  throws  IOException  {  String  str;      if  (value  instanceof  Date)  {  provider.defaultSerializeDateKey((Date)  value,  jgen);  return;  	Class<?>  cls  =  value.getClass();  if  (cls  ==  String.class)  {  str  =  (String)  value;  }  else  if  (Date.class.isAssignableFrom(cls))  {  }  else  if  (cls  ==  Class.class)  {  str  =  ((Class<?>)  value).getName();  	27	replace-1
362	JacksonCore_20	buggy:  throw  new  JsonGenerationException( "No  native  support  for  writing  embedded  objects ",  context:  public  abstract  void  writeNull()  throws  IOException;  public  void  writeEmbeddedObject(Object  object)  throws  IOException  {      throw  new  JsonGenerationException( "No  native  support  for  writing  embedded  objects ",  	if  (object  ==  null)  {  writeNull();  return;  }  if  (object  instanceof  byte[])  {  writeBinary((byte[])  object);  return;  }  throw  new  JsonGenerationException( "No  native  support  for  writing  embedded  objects  of  type   "  +object.getClass().getName(),  	1330	replace-1
523	Jsoup_37	buggy:  return  accum.toString().trim();  context:  public  String  html()  {  StringBuilder  accum  =  new  StringBuilder();  html(accum);      return  accum.toString().trim();  }  private  void  html(StringBuilder  accum)  {  for  (Node  node  :  childNodes)  node.outerHtml(accum);  }  	return  getOutputSettings().prettyPrint()  ?  accum.toString().trim()  :  accum.toString();  	1101	replace-1
57	Cli_32	buggy:  while  ((pos  <=  text.length())  &&  ((c  =  text.charAt(pos))  !=  '  ')  &&  (c  !=  '\n')  &&  (c  !=  '\r'))  {  ++pos;  }  context:  }  if  (pos  >  startPos)  {  return  pos;  }  pos  =  startPos  +  width;      while  ((pos  <=  text.length())  &&  ((c  =  text.charAt(pos))  !=  '  ')        &&  (c  !=  '\n')  &&  (c  !=  '\r'))      {      ++pos;      }  return  pos  ==  text.length()  ?  -1  :  pos;  }  	  	937	replace-5
385	JacksonDatabind_17	buggy:  ||  TreeNode.class.isAssignableFrom(t.getRawClass()));  context:  case  NON_CONCRETE_AND_ARRAYS:  while  (t.isArrayType())  {  t  =  t.getContentType();  }  case  OBJECT_AND_NON_CONCRETE:  return  (t.getRawClass()  ==  Object.class)  ||  (!t.isConcrete()          ||  TreeNode.class.isAssignableFrom(t.getRawClass()));  case  NON_FINAL:  while  (t.isArrayType())  {  t  =  t.getContentType();  }  return  !t.isFinal()  &&  !TreeNode.class.isAssignableFrom(t.getRawClass());  default:  	&&  !TreeNode.class.isAssignableFrom(t.getRawClass()));  	180	replace-1
329	Gson_5	buggy:  context:  TimeZone  timezone  =  null;  char  timezoneIndicator  =  date.charAt(offset);  if  (timezoneIndicator  ==  'Z')  {  timezone  =  TIMEZONE_UTC;  offset  +=  1;  }  else  if  (timezoneIndicator  ==  '+'  ||  timezoneIndicator  ==  '-')  {  String  timezoneOffset  =  date.substring(offset);  offset  +=  timezoneOffset.length();  if  ( "+0000 ".equals(timezoneOffset)  ||   "+00:00 ".equals(timezoneOffset))  {  timezone  =  TIMEZONE_UTC;  }  else  {  	timezoneOffset  =  timezoneOffset.length()  >=  5  ?  timezoneOffset  :  timezoneOffset  +   "00 ";  	214	add
49	Cli_24	buggy:  throw  new  IllegalStateException( "Total  width  is  less  than  the  width  of  the  argument  and  indent   "  +   "-  no  room  for  the  description ");  context:  {  sb.append(rtrim(text));  return  sb;  }  sb.append(rtrim(text.substring(0,  pos))).append(defaultNewLine);  if  (nextLineTabStop  >=  width)  {      throw  new  IllegalStateException( "Total  width  is  less  than  the  width  of  the  argument  and  indent   "  +                   "-  no  room  for  the  description ");  }  final  String  padding  =  createPadding(nextLineTabStop);  while  (true)  	nextLineTabStop  =  width  -  1;  	825	replace-2
507	Jsoup_21	buggy:  context:  Or(Collection<Evaluator>  evaluators)  {  super();  if  (evaluators.size()  >  1)  this.evaluators.add(new  And(evaluators));  else  //  0  or  1  this.evaluators.addAll(evaluators);  }  public  void  add(Evaluator  e)  {  evaluators.add(e);  }  public  boolean  matches(Element  root,  Element  node)  {  	Or()  {  super();  }  	64	add
339	Gson_15	buggy:  if  (Double.isNaN(value)  ||  Double.isInfinite(value))  {  context:  public  JsonWriter  value(double  value)  throws  IOException  {  writeDeferredName();  if  (Double.isNaN(value)  ||  Double.isInfinite(value))  {  throw  new  IllegalArgumentException( "Numeric  values  must  be  finite,  but  was   "  +  value);  }  beforeValue();  out.append(Double.toString(value));  return  this;  }  	if  (!lenient  &&  (Double.isNaN(value)  ||  Double.isInfinite(value)))  {  	495	replace-1
408	JacksonDatabind_40	buggy:  context:  }  return  _nullValue;  }  public  final  T  getNullValue()  {  return  _nullValue;  }  	@Override  public  T  getEmptyValue(DeserializationContext  ctxt)  throws  JsonMappingException  {  if  (_primitive  &&  ctxt.isEnabled(DeserializationFeature.FAIL_ON_NULL_FOR_PRIMITIVES))  {  throw  ctxt.mappingException(   "Can  not  map  Empty  String  as  null  into  type  %s  (set  DeserializationConfig.DeserializationFeature.FAIL_ON_NULL_FOR_PRIMITIVES  to  'false'  to  allow) ",  handledType().toString());  }  return  _nullValue;  }  	148	add
67	Collections_27	buggy:  context:  public  T  create()  {  try  {  return  clazz.newInstance();  }  catch  (final  Exception  ex)  {  throw  new  FunctorException( "Cannot  instantiate  class:   "  +  clazz,  ex);  }  }  }  }  	private  void  readObject(ObjectInputStream  is)  throws  IOException,  ClassNotFoundException  {  is.defaultReadObject();  if  (clazz  !=  null  &&  !Collection.class.isAssignableFrom(clazz))  {  throw  new  UnsupportedOperationException();  }  }  	568	add
562	Jsoup_76	buggy:  context:  if  (StringUtil.inSorted(tb.currentElement().nodeName(),  Constants.Headings))  {  tb.error(this);  tb.pop();  }  tb.insert(startTag);  }  else  if  (StringUtil.inSorted(name,  Constants.InBodyStartPreListing))  {  if  (tb.inButtonScope( "p "))  {  tb.processEndTag( "p ");  }  tb.insert(startTag);  tb.framesetOk(false);  }  else  if  (name.equals( "form "))  {  if  (tb.getFormElement()  !=  null)  {  tb.error(this);  return  false;  }  if  (tb.inButtonScope( "p "))  {  tb.processEndTag( "p ");  }  	tb.reader.matchConsume( "\n ");  //  ignore  LF  if  next  token  	382	add
479	JacksonDatabind_111	buggy:  return  new  SetterlessProperty(this,  deser,  _nullProvider);  }  context:  public  SettableBeanProperty  withName(PropertyName  newName)  {  return  new  SetterlessProperty(this,  newName);  }  public  SettableBeanProperty  withValueDeserializer(JsonDeserializer<?>  deser)  {  if  (_valueDeserializer  ==  deser)  {  return  this;  }      return  new  SetterlessProperty(this,  deser,  _nullProvider);  }  public  SettableBeanProperty  withNullProvider(NullValueProvider  nva)  {  return  new  SetterlessProperty(this,  _valueDeserializer,  nva);  }  	NullValueProvider  nvp  =  (_valueDeserializer  ==  _nullProvider)  ?  deser  :  _nullProvider;  return  new  SetterlessProperty(this,  deser,  nvp);  }  	68	replace-2
243	Codec_1	buggy:  return  txt.toUpperCase()  ;  context:  public  String  metaphone(String  txt)  {  boolean  hard  =  false  ;  if  ((txt  ==  null)  ||  (txt.length()  ==  0))  {  return   " "  ;  }  if  (txt.length()  ==  1)  {      return  txt.toUpperCase()  ;  }  char[]  inwd  =  txt.toUpperCase(java.util.Locale.ENGLISH).toCharArray()  ;  StringBuffer  local  =  new  StringBuffer(40);  //  manipulate  StringBuffer  code  =  new  StringBuffer(10)  ;  //    output  switch(inwd[0])  {  	return  txt.toUpperCase(java.util.Locale.ENGLISH)  ;  	88	replace-1
451	JacksonDatabind_83	buggy:  if  (_deserialize(text,  ctxt)  !=  null)  {  }  context:  if  (text  !=  null)  {  //  has  String  representation  if  (text.length()  ==  0  ||  (text  =  text.trim()).length()  ==  0)  {  return  _deserializeFromEmptyString();  }  Exception  cause  =  null;  try  {      if  (_deserialize(text,  ctxt)  !=  null)  {  return  _deserialize(text,  ctxt);      }  }  catch  (IllegalArgumentException  iae)  {  cause  =  iae;  }  catch  (MalformedURLException  me)  {  cause  =  me;  }  String  msg  =   "not  a  valid  textual  representation ";  if  (cause  !=  null)  {  		119	remove-2
311	Csv_4	buggy:  return  new  LinkedHashMap<String,  Integer>(this.headerMap);  context:  }  public  Map<String,  Integer>  getHeaderMap()  {      return  new  LinkedHashMap<String,  Integer>(this.headerMap);  }  	return  this.headerMap  ==  null  ?  null  :  new  LinkedHashMap<String,  Integer>(this.headerMap);  	288	replace-1
580	JxPath_1	buggy:  return  node  instanceof  Element;  context:  ||  testName.getName()  .equals(JDOMNodePointer.getLocalName(node)))  {  String  nodeNS  =  JDOMNodePointer.getNamespaceURI(node);  return  equalStrings(namespaceURI,  nodeNS);  }  }  else  if  (test  instanceof  NodeTypeTest)  {  switch  (((NodeTypeTest)  test).getNodeType())  {  case  Compiler.NODE_TYPE_NODE  :          return  node  instanceof  Element;  case  Compiler.NODE_TYPE_TEXT  :  return  (node  instanceof  Text)  ||  (node  instanceof  CDATA);  case  Compiler.NODE_TYPE_COMMENT  :  return  node  instanceof  Comment;  case  Compiler.NODE_TYPE_PI  :  return  node  instanceof  ProcessingInstruction;  }  return  false;  	return  (node  instanceof  Element)  ||  (node  instanceof  Document);  	376	replace-1
463	JacksonDatabind_95	buggy:  return  _factory._fromClass(null,  base,  null);  context:  if  (tokens.hasMoreTokens())  {  String  token  =  tokens.nextToken();  if  ( "< ".equals(token))  {  List<JavaType>  parameterTypes  =  parseTypes(tokens);  TypeBindings  b  =  TypeBindings.create(base,  parameterTypes);  return  _factory._fromClass(null,  base,  b);  }  tokens.pushBack(token);  }      return  _factory._fromClass(null,  base,  null);  }  protected  List<JavaType>  parseTypes(MyTokenizer  tokens)  throws  IllegalArgumentException  {  ArrayList<JavaType>  types  =  new  ArrayList<JavaType>();  while  (tokens.hasMoreTokens())  {  types.add(parseType(tokens));  	return  _factory._fromClass(null,  base,  TypeBindings.emptyBindings());  	59	replace-1
322	Csv_15	buggy:  if  (newRecord  &&  (c  <  0x20  ||  c  >  0x21  &&  c  <  0x23  ||  c  >  0x2B  &&  c  <  0x2D  ||  c  >  0x7E))  {  quote  =  true;  }  else  if  (c  <=  COMMENT)  {  context:  if  (newRecord)  {  quote  =  true;  }  }  else  {  char  c  =  value.charAt(pos);      if  (newRecord  &&  (c  <  0x20  ||  c  >  0x21  &&  c  <  0x23  ||  c  >  0x2B  &&  c  <  0x2D  ||  c  >  0x7E))  {          quote  =  true;      }  else  if  (c  <=  COMMENT)  {  quote  =  true;  }  else  {  while  (pos  <  end)  {  	if  (c  <=  COMMENT)  {  	1189	replace-3
569	Jsoup_83	buggy:  if  (c  ==  '\t'||  c  ==  '\n'||  c  ==  '\r'||  c  ==  '\f'||  c  ==  '  '||  c  ==  '/'||  c  ==  '>'||  c  ==  TokeniserState.nullChar)  context:  String  consumeTagName()  {  bufferUp();  final  int  start  =  bufPos;  final  int  remaining  =  bufLength;  final  char[]  val  =  charBuf;  while  (bufPos  <  remaining)  {  final  char  c  =  val[bufPos];      if  (c  ==  '\t'||  c  ==  '\n'||  c  ==  '\r'||  c  ==  '\f'||  c  ==  '  '||  c  ==  '/'||  c  ==  '>'||  c  ==  TokeniserState.nullChar)  break;  bufPos++;  }  return  bufPos  >  start  ?  cacheString(charBuf,  stringCache,  start,  bufPos  -start)  :   " ";  }  String  consumeToEnd()  {  	if  (c  ==  '\t'||  c  ==    '\n'||  c  ==    '\r'||  c  ==    '\f'||  c  ==    '  '||  c  ==    '/'||  c  ==    '>'||  c  ==  '<'  ||  c  ==    TokeniserState.nullChar)  	254	replace-1
373	JacksonDatabind_5	buggy:  context:  if  (am  !=  null)  {  _addMixUnders(m,  am);  }  else  {  mixIns.add(_constructMethod(m));  }  }  }  }  	am  =  mixIns.find(m);  if  (am  !=  null)  {  _addMixUnders(m,  am);  }  else  {  }  	658	add
290	Compress_30	buggy:  context:  if  (len  <  0)  {  throw  new  IndexOutOfBoundsException( "len( "  +  len  +   ")  <  0. ");  }  if  (offs  +  len  >  dest.length)  {  throw  new  IndexOutOfBoundsException( "offs( "  +  offs  +   ")  +  len( "  }  if  (this.in  ==  null)  {  throw  new  IOException( "stream  closed ");  }  final  int  hi  =  offs  +  len;  int  destOffs  =  offs;  int  b;  while  (destOffs  <  hi  &&  ((b  =  read0())  >=  0))  {  dest[destOffs++]  =  (byte)  b;  count(1);  	if  (len  ==  0)  {  return  0;  }  	168	add
286	Compress_26	buggy:  context:  public  static  long  skip(InputStream  input,  long  numToSkip)  throws  IOException  {  long  available  =  numToSkip;  while  (numToSkip  >  0)  {  long  skipped  =  input.skip(numToSkip);  if  (skipped  ==  0)  {  break;  }  numToSkip  -=  skipped;  }  	if  (numToSkip  >  0)  {  byte[]  skipBuf  =  new  byte[SKIP_BUF_SIZE];  while  (numToSkip  >  0)  {  int  read  =  readFully(input,  skipBuf,  0,  (int)  Math.min(numToSkip,  SKIP_BUF_SIZE));  if  (read  <  1)  {  break;  }  numToSkip  -=  read;  }  }  	104	add
333	Gson_9	buggy:  context:  put(JsonNull.INSTANCE);  return  this;  }  put(new  JsonPrimitive(value));  return  this;  }  if  (!isLenient()  &&  (Double.isNaN(value)  ||  Double.isInfinite(value)))  {  	@Override  public  JsonWriter  value(Boolean  value)  throws  IOException  {  if  (value  ==  null)  {  return  nullValue();  }  put(new  JsonPrimitive(value));  return  this;  }  	162	add
53	Cli_28	buggy:  break;  context:  }  }  }  else  if  (!( "yes ".equalsIgnoreCase(value)  ||   "true ".equalsIgnoreCase(value)  ||   "1 ".equalsIgnoreCase(value)))  {          break;  }  cmd.addOption(opt);  }  }  }  	continue;  	290	replace-1
487	Jsoup_1	buggy:  body().appendChild(new  TextNode( "   ",   " "));  body().appendChild(node);  context:  for  (Node  node:  element.childNodes)  {  if  (node  instanceof  TextNode)  {  TextNode  tn  =  (TextNode)  node;  if  (!tn.isBlank())  toMove.add(tn);  }  }  for  (Node  node:  toMove)  {  element.removeChild(node);      body().appendChild(new  TextNode( "   ",   " "));      body().appendChild(node);  }  }  public  String  outerHtml()  {  return  super.html();  //  no  outer  wrapper  tag  	body().prependChild(node);  body().prependChild(new  TextNode( "   ",   " "));  	125	replace-2
405	JacksonDatabind_37	buggy:  return  new  SimpleType(subclass,  _bindings,  _superClass,  _superInterfaces,  context:  if  (!_class.isAssignableFrom(subclass))  {  throw  new  IllegalArgumentException( "Class   "+subclass.getName()+ "  not  sub-type  of   "  }      return  new  SimpleType(subclass,  _bindings,  _superClass,  _superInterfaces,  _valueHandler,  _typeHandler,  _asStatic);  }  public  JavaType  withContentType(JavaType  contentType)  {  throw  new  IllegalArgumentException( "Simple  types  have  no  content  types;  can  not  call  withContentType() ");  }  	return  new  SimpleType(subclass,  _bindings,  this,  _superInterfaces,  	135	replace-1
258	Codec_16	buggy:  25,  26,  27,  28,  29,  30,  31,  32,  context:  private  static  final  byte[]  HEX_DECODE_TABLE  =  {  1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  //  00-0f  1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  //  10-1f  1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  -1,  //  20-2f  0,  1,  2,  3,  4,  5,  6,  7,  8,  9,  -1,  -1,  -1,  -1,  -1,  -1,  //  30-3f  2-7  1,  10,  11,  12,  13,  14,  15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  //  40-4f  A-O      25,  26,  27,  28,  29,  30,  31,  32,  };  private  static  final  byte[]  HEX_ENCODE_TABLE  =  {  '0',  '1',  '2',  '3',  '4',  '5',  '6',  '7',  '8',  '9',  	25,  26,  27,  28,  29,  30,  31,                                                                          //  50-57  P-V  	99	replace-1
526	Jsoup_40	buggy:  Validate.notEmpty(name);  context:  public  DocumentType(String  name,  String  publicId,  String  systemId,  String  baseUri)  {  super(baseUri);      Validate.notEmpty(name);  attr( "name ",  name);  attr( "publicId ",  publicId);  attr( "systemId ",  systemId);  }  public  String  nodeName()  {  return   "#doctype ";  }  		22	remove-1
467	JacksonDatabind_99	buggy:  context:  _valueHandler,  _typeHandler,  _asStatic);  }  protected  String  buildCanonicalName()  {  StringBuilder  sb  =  new  StringBuilder();  sb.append(_class.getName());  sb.append('<');  sb.append(_referencedType.toCanonical());  return  sb.toString();  }  	sb.append('>');  	169	add
444	JacksonDatabind_76	buggy:  if  (buffer.assignParameter(creatorProp,  creatorProp.deserialize(p,  ctxt)))  {  t  =  p.nextToken();  Object  bean;  try  {  bean  =  creator.build(ctxt,  buffer);  }  catch  (Exception  e)  {  wrapAndThrow(e,  _beanType.getRawClass(),  propName,  ctxt);  continue;  }  while  (t  ==  JsonToken.FIELD_NAME)  {  p.nextToken();  tokens.copyCurrentStructure(p);  t  =  p.nextToken();  }  tokens.writeEndObject();  if  (bean.getClass()  !=  _beanType.getRawClass())  {  ctxt.reportMappingException( "Can  not  create  polymorphic  instances  with  unwrapped  values ");  return  null;  }  return  _unwrappedPropertyHandler.processUnwrapped(p,  ctxt,  bean,  tokens);  }  context:  TokenBuffer  tokens  =  new  TokenBuffer(p,  ctxt);  tokens.writeStartObject();  JsonToken  t  =  p.getCurrentToken();  for  (;  t  ==  JsonToken.FIELD_NAME;  t  =  p.nextToken())  {  String  propName  =  p.getCurrentName();  p.nextToken();  //  to  point  to  value  SettableBeanProperty  creatorProp  =  creator.findCreatorProperty(propName);  if  (creatorProp  !=  null)  {      if  (buffer.assignParameter(creatorProp,  creatorProp.deserialize(p,  ctxt)))  {          t  =  p.nextToken();          Object  bean;          try  {          bean  =  creator.build(ctxt,  buffer);          }  catch  (Exception  e)  {          wrapAndThrow(e,  _beanType.getRawClass(),  propName,  ctxt);          continue;          }          while  (t  ==  JsonToken.FIELD_NAME)  {  	buffer.assignParameter(creatorProp,  creatorProp.deserialize(p,  ctxt));  	583	replace-21
503	Jsoup_17	buggy:  private  static  String  nullString  =  String.valueOf(0x0000);  context:  return  true;  }  },  ForeignContent  {  boolean  process(Token  t,  TreeBuilder  tb)  {  return  true;  }  };  private  static  String  nullString  =  String.valueOf(0x0000);  abstract  boolean  process(Token  t,  TreeBuilder  tb);  private  static  boolean  isWhitespace(Token  t)  {  if  (t.isCharacter())  {  String  data  =  t.asCharacter().getData();  for  (int  i  =  0;  i  <  data.length();  i++)  {  	private  static  String  nullString  =  String.valueOf('\u0000');  	1451	replace-1
37	Cli_12	buggy:  if  (options.hasOption(arg.substring(0,  2)))  context:  else  if  (arg.startsWith( "- "))  {  String  opt  =  Util.stripLeadingHyphens(arg);  if  (options.hasOption(opt))  {  tokens.add(arg);  }  else  {          if  (options.hasOption(arg.substring(0,  2)))  {  	if  (opt.indexOf('=')  !=  -1  &&  options.hasOption(opt.substring(0,  opt.indexOf('='))))  tokens.add(arg.substring(0,  arg.indexOf('=')));  //  --foo  tokens.add(arg.substring(arg.indexOf('=')  +  1));  //  value  }  else  if  (options.hasOption(arg.substring(0,  2)))  {  	81	replace-1
267	Compress_7	buggy:  if  (buffer[i]  ==  0)  {  result.append((char)  buffer[i]);  context:  public  static  String  parseName(byte[]  buffer,  final  int  offset,  final  int  length)  {  StringBuffer  result  =  new  StringBuffer(length);  int      end  =  offset  +  length;  for  (int  i  =  offset;  i  <  end;  ++i)  {      if  (buffer[i]  ==  0)  {  break;  }      result.append((char)  buffer[i]);  }  return  result.toString();  	byte  b  =  buffer[i];  if  (b  ==  0)  {  //  Trailing  null  result.append((char)  (b  &  0xFF));  //  Allow  for  sign-extension  	98	replace-2
38	Cli_13	buggy:  context:  void  addValue(final  Option  option,  final  Object  value);  void  setDefaultValues(final  Option  option,  final  List  defaultValues);  	List  getUndefaultedValues(final  Option  option);  	47	add
527	Jsoup_41	buggy:  return  this  ==  o;  context:  }  public  boolean  equals(Object  o)  {  if  (this  ==  o)  return  true;  if  (o  ==  null  ||  getClass()  !=  o.getClass())  return  false;  if  (!super.equals(o))  return  false;  Element  element  =  (Element)  o;      return  this  ==  o;  }  public  int  hashCode()  {  int  result  =  super.hashCode();  result  =  31  *  result  +  (tag  !=  null  ?  tag.hashCode()  :  0);  return  result;  }  	return  tag.equals(element.tag);  	1175	replace-1
466	JacksonDatabind_98	buggy:  buffer.assignParameter(typeProp,  typeId);  context:  if  (prop.getCreatorIndex()  >=  0)  {  buffer.assignParameter(prop,  values[i]);  SettableBeanProperty  typeProp  =  extProp.getTypeProperty();  if  ((typeProp  !=  null)  &&  (typeProp.getCreatorIndex()  >=  0))  {          buffer.assignParameter(typeProp,  typeId);  	final  Object  v;  if  (typeProp.getType().hasRawClass(String.class))  {  v  =  typeId;  }  else  {  TokenBuffer  tb  =  new  TokenBuffer(p,  ctxt);  tb.writeString(typeId);  v  =  typeProp.getValueDeserializer().deserialize(tb.asParserOnFirstToken(),  ctxt);  tb.close();  }  buffer.assignParameter(typeProp,  v);  	298	replace-1
345	JacksonCore_3	buggy:  context:  byte[]  inputBuffer,  int  start,  int  end,  boolean  bufferRecyclable)  {  super(ctxt,  features);  _inputStream  =  in;  _objectCodec  =  codec;  _symbols  =  sym;  _inputBuffer  =  inputBuffer;  _inputPtr  =  start;  _inputEnd  =  end;  _bufferRecyclable  =  bufferRecyclable;  }  public  ObjectCodec  getCodec()  {  return  _objectCodec;  }  	_currInputRowStart  =  start;  _currInputProcessed  =  -start;  	125	add
543	Jsoup_57	buggy:  attributes.remove(attrKey);  context:  Remove  an  attribute  by  key.  <b>Case  insensitive.</b>  public  void  removeIgnoreCase(String  key)  {  Validate.notEmpty(key);  if  (attributes  ==  null)  return;  for  (Iterator<String>  it  =  attributes.keySet().iterator();  it.hasNext();  )  {  String  attrKey  =  it.next();  if  (attrKey.equalsIgnoreCase(key))      attributes.remove(attrKey);  }  }  Tests  if  these  attributes  contain  an  attribute  with  this  key.  	it.remove();  	125	replace-1
601	JxPath_22	buggy:  return  attr.getValue();  return  null;  return  uri;  context:  String  uri  =  element.getNamespaceURI();  if  (uri  ==  null)  {  String  prefix  =  getPrefix(node);  String  qname  =  prefix  ==  null  ?   "xmlns "  :   "xmlns: "  +  prefix;  Node  aNode  =  node;  while  (aNode  !=  null)  {  if  (aNode.getNodeType()  ==  Node.ELEMENT_NODE)  {  Attr  attr  =  ((Element)  aNode).getAttributeNode(qname);  if  (attr  !=  null)  {          return  attr.getValue();  }  }  aNode  =  aNode.getParentNode();  }      return  null;  }      return  uri;  	uri  =  attr.getValue();  break;  return   " ".equals(uri)  ?  null  :  uri;  	689	replace-3
316	Csv_9	buggy:  context:  return  toList().iterator();  }  <M  extends  Map<String,  String>>  M  putIn(final  M  map)  {  for  (final  Entry<String,  Integer>  entry  :  mapping.entrySet())  {  final  int  col  =  entry.getValue().intValue();  if  (col  <  values.length)  {  map.put(entry.getKey(),  values[col]);  }  }  return  map;  	if  (mapping  ==  null)  {  return  map;  }  	180	add
429	JacksonDatabind_61	buggy:  context:  public  boolean  useForType(JavaType  t)  {  switch  (_appliesFor)  {  case  NON_CONCRETE_AND_ARRAYS:  while  (t.isArrayType())  {  t  =  t.getContentType();  }  	if  (t.isPrimitive())  {  return  false;  }  	232	add
259	Codec_17	buggy:  return  new  String(bytes,  Charsets.ISO_8859_1);  context:  public  static  String  newStringIso8859_1(final  byte[]  bytes)  {      return  new  String(bytes,  Charsets.ISO_8859_1);  }  	return  newString(bytes,  Charsets.ISO_8859_1);  	339	replace-1
287	Compress_27	buggy:  if  (start  ==  end)  {  throw  new  IllegalArgumentException(  exceptionMessage(buffer,  offset,  length,  start,  trailer));  }  context:  byte  trailer  =  buffer[end  -  1];  while  (start  <  end  &&  (trailer  ==  0  ||  trailer  ==  '  '))  {  end--;  trailer  =  buffer[end  -  1];  }      if  (start  ==  end)  {      throw  new  IllegalArgumentException(          exceptionMessage(buffer,  offset,  length,  start,  trailer));      }  for  (  ;start  <  end;  start++)  {  final  byte  currentByte  =  buffer[start];  if  (currentByte  <  '0'  ||  currentByte  >  '7'){  throw  new  IllegalArgumentException(  		133	remove-4
54	Cli_29	buggy:  if  (str.startsWith( "\ " "))  {  str  =  str.substring(1,  str.length());  }  if  (str.endsWith( "\ " "))  str  =  str.substring(0,  length  -  1);  context:  static  String  stripLeadingAndTrailingQuotes(String  str)  {      if  (str.startsWith( "\ " "))      {      str  =  str.substring(1,  str.length());      }  int  length  =  str.length();      if  (str.endsWith( "\ " "))  {      str  =  str.substring(0,  length  -  1);  	if  (length  >  1  &&  str.startsWith( "\ " ")  &&  str.endsWith( "\ " ")  &&  str.substring(1,  length  -  1).indexOf(' "')  ==  -1)  str  =  str.substring(1,  length  -  1);  	65	replace-6
291	Compress_31	buggy:  if  (currentByte  ==  0)  {  break;  }  context:  byte  trailer  =  buffer[end  -  1];  while  (start  <  end  &&  (trailer  ==  0  ||  trailer  ==  '  '))  {  end--;  trailer  =  buffer[end  -  1];  }  for  (  ;start  <  end;  start++)  {  final  byte  currentByte  =  buffer[start];      if  (currentByte  ==  0)  {      break;      }  if  (currentByte  <  '0'  ||  currentByte  >  '7'){  throw  new  IllegalArgumentException(  exceptionMessage(buffer,  offset,  length,  start,  currentByte));  }  result  =  (result  <<  3)  +  (currentByte  -  '0');  //  convert  from  ASCII  		135	remove-3
568	Jsoup_82	buggy:  context:  if  (bomCharset  !=  null  &&  bomCharset.offset)  //  creating  the  buffered  reader  ignores  the  input  pos,  so  must  skip  here  reader.skip(1);  try  {  doc  =  parser.parseInput(reader,  baseUri);  }  catch  (UncheckedIOException  e)  {  throw  e.ioException();  }  Charset  charset  =  Charset.forName(charsetName);  doc.outputSettings().charset(charset);  }  input.close();  return  doc;  }  	if  (!charset.canEncode())  {  doc.charset(Charset.forName(defaultCharset));  }  	171	add
321	Csv_14	buggy:  if  (newRecord  &&  (c  <  '0'  ||  c  >  '9'  &&  c  <  'A'  ||  c  >  'Z'  &&  c  <  'a'  ||  c  >  'z'))  {  context:  if  (newRecord)  {  quote  =  true;  }  }  else  {  char  c  =  value.charAt(pos);      if  (newRecord  &&  (c  <  '0'  ||  c  >  '9'  &&  c  <  'A'  ||  c  >  'Z'  &&  c  <  'a'  ||  c  >  'z'))  {  quote  =  true;  }  else  if  (c  <=  COMMENT)  {  quote  =  true;  }  else  {  while  (pos  <  end)  {  	if  (newRecord  &&  (c  <  0x20  ||  c  >  0x21  &&  c  <  0x23  ||  c  >  0x2B  &&  c  <  0x2D  ||  c  >  0x7E))  {  	1039	replace-1
306	Compress_46	buggy:  final  long  TWO_TO_32  =  0x100000000L;  if  (l  >=  TWO_TO_32)  {  context:  private  static  ZipLong  dateToZipLong(final  Date  d)  {  if  (d  ==  null)  {  return  null;  }  return  unixTimeToZipLong(d.getTime()  /  1000);  }  private  static  ZipLong  unixTimeToZipLong(long  l)  {      final  long  TWO_TO_32  =  0x100000000L;      if  (l  >=  TWO_TO_32)  {  throw  new  IllegalArgumentException( "X5455  timestamps  must  fit  in  a  signed  32  bit  integer:   "  +  l);  }  return  new  ZipLong(l);  }  	if  (l  <  Integer.MIN_VALUE  ||  l  >  Integer.MAX_VALUE)  {  	529	replace-2
483	JacksonXml_3	buggy:  _currText  =  _xmlTokens.getText();  break;  context:  _nextToken  =  JsonToken.FIELD_NAME;  _currText  =  _xmlTokens.getText();  _parsingContext  =  _parsingContext.createChildObjectContext(-1,  -1);  _currToken  =  JsonToken.START_OBJECT;  }  else  {  _parsingContext.setCurrentName(_xmlTokens.getLocalName());  _currToken  =  JsonToken.FIELD_NAME;  }  break;  case  XmlTokenStream.XML_ATTRIBUTE_VALUE:      _currText  =  _xmlTokens.getText();  _currToken  =  JsonToken.VALUE_STRING;      break;  case  XmlTokenStream.XML_TEXT:  _currText  =  _xmlTokens.getText();  if  (_mayBeLeaf)  {  _mayBeLeaf  =  false;  _xmlTokens.skipEndElement();  	return  (_currText  =  _xmlTokens.getText());  	669	replace-2
450	JacksonDatabind_82	buggy:  ignored  =  ignorals.getIgnored();  context:  JsonIgnoreProperties.Value  ignorals  =  ctxt.getConfig()  .getDefaultPropertyIgnorals(beanDesc.getBeanClass(),  beanDesc.getClassInfo());  Set<String>  ignored;  if  (ignorals  !=  null)  {  boolean  ignoreAny  =  ignorals.getIgnoreUnknown();  builder.setIgnoreUnknownProperties(ignoreAny);      ignored  =  ignorals.getIgnored();  for  (String  propName  :  ignored)  {  builder.addIgnorable(propName);  }  }  else  {  ignored  =  Collections.emptySet();  }  	ignored  =  ignorals.findIgnoredForDeserialization();  	495	replace-1
312	Csv_5	buggy:  context:  }  public  void  println()  throws  IOException  {  final  String  recordSeparator  =  format.getRecordSeparator();  out.append(recordSeparator);  newRecord  =  true;  }  	if  (recordSeparator  !=  null)  {  }  	325	add
66	Collections_26	buggy:  private  Object  readResolve()  {  context:  }  hashCode  =  total;  }  private  Object  readResolve()  {  calculateHashCode(keys);  return  this;  }  }  	protected  Object  readResolve()  {  	277	replace-1
563	Jsoup_77	buggy:  String  elName  =  endTag.name();  context:  insertNode(doctypeNode);  }  private  void  popStackToClose(Token.EndTag  endTag)  {      String  elName  =  endTag.name();  Element  firstFound  =  null;  for  (int  pos  =  stack.size()  -1;  pos  >=  0;  pos--)  {  Element  next  =  stack.get(pos);  if  (next.nodeName().equals(elName))  {  firstFound  =  next;  break;  }  	String  elName  =  endTag.normalName();  	117	replace-1
384	JacksonDatabind_16	buggy:  return  (previous  !=  null)  &&  previous.equals(ann);  context:  protected  final  boolean  _add(Annotation  ann)  {  if  (_annotations  ==  null)  {  _annotations  =  new  HashMap<Class<?  extends  Annotation>,Annotation>();  }  Annotation  previous  =  _annotations.put(ann.annotationType(),  ann);      return  (previous  !=  null)  &&  previous.equals(ann);  }  }  	return  (previous  ==  null)  ||  !previous.equals(ann);  	112	replace-1
50	Cli_25	buggy:  nextLineTabStop  =  width  -  1;  context:  {  sb.append(rtrim(text));  return  sb;  }  sb.append(rtrim(text.substring(0,  pos))).append(defaultNewLine);  if  (nextLineTabStop  >=  width)  {      nextLineTabStop  =  width  -  1;  }  final  String  padding  =  createPadding(nextLineTabStop);  while  (true)  {  	nextLineTabStop  =  1;  	825	replace-1
506	Jsoup_20	buggy:  context:  }  }  }  else  {  //  specified  by  content  type  header  (or  by  user  on  file  load)  Validate.notEmpty(charsetName,   "Must  set  charset  arg  to  character  set  of  file  to  parse.  Set  to  null  to  attempt  to  detect  from  HTML ");  docData  =  Charset.forName(charsetName).decode(byteData).toString();  }  if  (doc  ==  null)  {  doc  =  parser.parseInput(docData,  baseUri);  doc.outputSettings().charset(charsetName);  }  return  doc;  }  static  ByteBuffer  readToByteBuffer(InputStream  inStream)  throws  IOException  {  	if  (docData.charAt(0)  ==  65279)  docData  =  docData.substring(1);  	98	add
474	JacksonDatabind_106	buggy:  context:  }  public  float  getFloatValue()  throws  IOException  {  return  (float)  currentNumericNode().doubleValue();  }  public  int  getIntValue()  throws  IOException  {  final  NumericNode  node  =  (NumericNode)  currentNumericNode();  return  node.intValue();  }  public  long  getLongValue()  throws  IOException  {  final  NumericNode  node  =  (NumericNode)  currentNumericNode();  	if  (!node.canConvertToInt())  {  reportOverflowInt();  }  if  (!node.canConvertToInt())  {  reportOverflowLong();  }  	308	add
425	JacksonDatabind_57	buggy:  return  _bindAndReadValues(_considerFilter(_parserFactory.createParser(src),  context:  public  <T>  MappingIterator<T>  readValues(byte[]  src,  int  offset,  int  length)  throws  IOException,  JsonProcessingException  {  if  (_dataFormatReaders  !=  null)  {  return  _detectBindAndReadValues(_dataFormatReaders.findFormat(src,  offset,  length),  false);  }      return  _bindAndReadValues(_considerFilter(_parserFactory.createParser(src),  true));  }  public  final  <T>  MappingIterator<T>  readValues(byte[]  src)  throws  IOException,  JsonProcessingException  {  	return  _bindAndReadValues(_considerFilter(_parserFactory.createParser(src,  offset,  length),  	1441	replace-1
593	JxPath_14	buggy:  context:  }  return  new  Double(sum);  }  throw  new  JXPathException(   "Invalid  argument  type  for  'sum':   "  +  v.getClass().getName());  }  protected  Object  functionFloor(EvalContext  context)  {  assertArgCount(1);  double  v  =  InfoSetUtil.doubleValue(getArg1().computeValue(context));  return  new  Double(Math.floor(v));  }  protected  Object  functionCeiling(EvalContext  context)  {  assertArgCount(1);  double  v  =  InfoSetUtil.doubleValue(getArg1().computeValue(context));  	if  (Double.isNaN(v)  ||  Double.isInfinite(v))  {  return  new  Double(v);  }  if  (Double.isNaN(v)  ||  Double.isInfinite(v))  {  return  new  Double(v);  }  if  (Double.isNaN(v)  ||  Double.isInfinite(v))  {  return  new  Double(v);  }  	656	add
547	Jsoup_61	buggy:  final  String  classAttr  =  attributes.get( "class ");  context:  return  this;  }  public  boolean  hasClass(String  className)  {      final  String  classAttr  =  attributes.get( "class ");  final  int  len  =  classAttr.length();  final  int  wantLen  =  className.length();  if  (len  ==  0  ||  len  <  wantLen)  {  return  false;  }  	final  String  classAttr  =  attributes.getIgnoreCase( "class ");  	1092	replace-1
243	Codec_1	buggy:  txt = txt.toLowerCase() ;  context:  public String caverphone(String txt) { boolean   if( txt == null || txt.length() == 0 ) { return "1111111111"; }  txt = txt.replaceAll("[^a-z]", ""); txt = txt.replaceAll("e$", "");   	txt = txt.toLowerCase(java.util.Locale.ENGLISH);  	59	replace-1
243	Codec_1	buggy:  return str.toUpperCase();  context:  for (int i = 0; i < len; i++) {  if (Character.isLetter(str.charAt(i))) { chars[count++] = str.charAt(i);  } } if (count == len) { return str.toUpperCase(); } return new String(chars, 0, count).toUpperCase(java.util.Locale.ENGLISH); } 	return str.toUpperCase(java.util.Locale.ENGLISH);  	53	replace-1
234	Closure_168	buggy: if (t.getScopeDepth() <= 2) { context: if (n.isReturn() && n.getFirstChild() != null) { data.get(t.getScopeRoot()).recordNonEmptyReturn(); } if (t.getScopeDepth() <= 2) {  return; }	if (t.getScopeDepth() <= 1) {	1996	replace-1
